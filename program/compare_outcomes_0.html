<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title></title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>

<!-- MathJax scripts -->
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<pre><code class="r">% path0 &lt;- &quot;c:/data/GUK/&quot;; path &lt;- paste0(path0, &quot;analysis/&quot;); setwd(pathprogram &lt;- paste0(path, &quot;program/&quot;)); pathsource.mar &lt;- paste0(path, &quot;source/mar/&quot;); pathreceived.nar &lt;- paste0(path0, &quot;received/mar/&quot;)
%   path0 &lt;- &quot;c:/data/GUK/&quot;; path &lt;- paste0(path0, &quot;analysis/&quot;); setwd(pathprogram &lt;- paste0(path, &quot;program/&quot;)); pathsource.mar &lt;- paste0(path, &quot;source/mar/&quot;); pathreceived.nar &lt;- paste0(path0, &quot;received/mar/&quot;); system(&quot;recycle c:/data/GUK/analysis/program/cache/compare_outcomes_0/&quot;); library(knitr); knit(&quot;compare_outcomes_0.rnw&quot;, &quot;compare_outcomes_0.tex&quot;); system(&quot;platex compare_outcomes_0&quot;); system(&quot;pbibtex compare_outcomes_0&quot;); system(&quot;dvipdfmx compare_outcomes_0&quot;)

\input{c:/data/knitr_preamble.rnw}
\def\pgfsysdriver{pgfsys-dvipdfm.def}
\usepackage{tikz}
\usepackage{fancyhdr}
\usetikzlibrary{calc, arrows, decorations, decorations.pathreplacing, backgrounds}
\tikzstyle{toprow} =
[
top color = gray!20, bottom color = gray!50, thick
]
\tikzstyle{maintable} =
[
top color = blue!1, bottom color = blue!20, draw = white
]
\tikzset{
%Define standard arrow tip
&gt;=stealth&#39;,
%Define style for different line styles
help lines/.style={dashed, thick},
axis/.style={&lt;-&gt;},
important line/.style={thick},
connection/.style={thick, dotted},
}


\begin{document}
\setlength{\baselineskip}{12pt}

&lt;&lt;option setting 1, cache = F, child=&#39;c:/data/knitr_initial_option_setting_chunk.rnw&#39;&gt;&gt;=
&lt;&lt;option setting 2, cache = F&gt;&gt;=
opts_chunk$set(fig.path=&#39;figure/compare_outcomes_0&#39;, cache.path=&#39;cache/compare_outcomes_0&#39;, cache = F, echo = F, results = &#39;hide&#39;, tidy.opts=list(blank=FALSE, width.cutoff=40))
options(digits = 6, width = 80)
library(data.table)
pathsave &lt;- paste0(path, &quot;save/&quot;)
pathreceived.oct &lt;- paste0(path0, &quot;received/oct/&quot;)
@

\hfil Comparing outcomes between groups\\

\hfil\MonthDY\\
\hfil{\footnotesize\currenttime}\\

\hfil Seiro Ito

\tableofcontents

\setlength{\parindent}{1em}

\vspace{2ex}

There are a few key variables.
\begin{itemize}
\vspace{1.0ex}\setlength{\itemsep}{1.0ex}\setlength{\baselineskip}{12pt}
\item   \textsf{receivedCredit}: The actual treatment status. This is time-invariant. It is T if a subject is receives a loan in our observation period.
\item   \textsf{assignment}: The original treatment assignement. This is time-invariant. This differs from \textsf{receivedCredit} because in our design everyone is deemed to get treated at the end (but there are subjects who opted out of a loan but remained in a group).
\item   \textsf{disbursed}: If a subject received a loan. This is time-variant.
\item   \textsf{elapsed}: The number of days since receiving a loan at rd 3 interview date. This is time-invariant as it is computed only at rd 3. This defines the eventual treatment dose and should be our main covariate.
\end{itemize}

Following results are obtained.
\begin{description}
\vspace{1.0ex}\setlength{\itemsep}{1.0ex}\setlength{\baselineskip}{12pt}
\item[Figure 1] This plots the mean of ``3 meals per day&#39;&#39; in each round. Left panel is control vs. treated in \textsf{receivedCredit} (actual assignmemt). Right panel is control vs. treated in \textsf{assignment} (original assignment). The question is changed in rd 2 onwards so direct comparison across rd 1 and 2,3 are not tenable. However, one sees a rising ``3 meals per day&#39;&#39;, but almost paralel trend between rd 2 and 3 (which are comparable).
\item[Table 1]  This is a first-difference (linear probability) estimation result of ``3 meals per day&#39;&#39; on \textsf{disbursed}, \textsf{arm}, their interactions, \textsf{assignment}, \textsf{elapsed} days, using the post treatment data of rds 2, 3. It shows positive impacts of receiving a loan (\textsf{disbursed} under the covariate name ``credit&#39;&#39;) aafter controlling for \textsf{arm}. \textsf{control/treated} are relative to ``lost to flood&#39;&#39; or ``rejections,&#39;&#39; so it is not surprising to have better food intake.
\item[Figure 2] Livestock is the main stated usage of loans.
\item[Figure 3] Work hours seem to get longer.
\item[Figure 4] New loans increased in rd 2, whose recall period corresponds to the timing disbursement.
\item[Figure 5] Asset holding by \textsf{receivedCredit}= T/F and rds = 1,2,3. Asset holding is computed with rd 1 asset holding, asset addition in rd 2, 3, while assuming an annual rate of 5\% depreciation. \textsf{receivedCredit} not randomised allocation as loan receipt must be agreed by subjects. It shows that the loan receivers have higher mean asset in rd 3, but not in rd 1 or 2, where the latter is good. Red dotted lines are medians, blue dotted lines are means.
\item[Figure 6] Asset holding by \textsf{disbursed}=T/F and rds=1,2,3. This is also an endogenous switch. The basic picture is the same as Figure 5.
\item[Figure 7] Asset holding by \textsf{elapsed} days grouped into ``early receivers&#39;&#39; and ``late receivers&#39;&#39; according to median elapsed day. This is (roughly) a randomised switch. It shows increasing asset levels, but no mean or median difference between early and late receivers.
\item[Figure 8] Asset holding by \textsf{elapsed} days and \textsf{arms}. Not much to see here.
\item[Figure 9] Difference in group-average asset holding between the treated and the control in \textsf{assignment} by difference in \textsf{elapsed} and \textsf{arms}. So it is group differences among original treatment assignment (treated - control) within the same cluster. It controls for cluster FE, and dose and outcome differences are taken between randomly assigned treatment status. This should be one of our main comparisons. (This is not DID: If I plot the first-difference version of the plots between rds, it will be double difference estimates.) When I draw loess curves, I see no trend over various elapsed day (``treatment dose&#39;&#39;) differences. It hints a zero gradient of dose levels.
\item[Figure 10]    Same identification idea as Figure 9 on livestock values. Again, we do not see markedly strong impacts, but we see some differences in terms of dispersion. \textsf{cow} arm has smaller variations around the loess curves in rds 2 and 3 relative to the \textsf{large grace} arm. \textsf{traditional} arm has a simlar pattern as \textsf{large grace}.
\item[Figure 11]    Livestock holding by \textsf{elapsed} days. Substantial heterogeneity in rd 3 but no statistical significant changes.
\item[Figure 13]    Total asset holding by \textsf{elapsed} days. Substantial heterogeneity in rd 3 but no statistical significant changes.
\item[Table 3]  DID estimation of total asset holding by \textsf{elapsed} days. Zero impact.
\end{description}

\underline{Please ignore} the texts hereafter as they are my memos in programming.


\section{Read}

List folder names and read files.
&lt;&lt;warning = F&gt;&gt;=
setwd(pathsource.mar)
foldername &lt;- list.dirs(path = &quot;.&quot;, recursive = T, full.names = T)
foldername &lt;- foldername[!grepl(&quot;add|ori|^\\.$|1$&quot;, foldername)]
fn &lt;- unique(list.files(path = foldername, pattern = &quot;.prn$&quot;, 
    recursive = T, full.names = T))
X = lapply(fn, fread, integer64 = &quot;double&quot;)
@

\section{Treatment through time}

&lt;&lt;echo = F, results = &#39;hide&#39;&gt;&gt;=
setwd(pathsave)
tr &lt;- fread(&quot;treatment_assignment.prn&quot;)
tr0 &lt;- tr[, .(gid, hhid, memstatus, assignment, arm, receivedCredit, 
    elapsed, daysFromStart)]
table(tr0[is.na(receivedCredit), .(memstatus, arm)])
@
Treatment assignment file. There are \Sexpr{table(tr0[, assignment])[1]} cases of attrition who are group rejections (\Sexpr{table(tr0[, memstatus])[&quot;group rejection&quot;]}) and lost to flood (\Sexpr{table(tr0[, memstatus])[&quot;lost to flood&quot;]}). 
&lt;&lt;&gt;&gt;=
setwd(pathsave)
tr &lt;- fread(&quot;treatment_assignment.prn&quot;)
tr[, disburseDate := as.POSIXct(disburseDate, format = &quot;%Y-%m-%d&quot;)]
tr[, purchaseDate := as.POSIXct(purchaseDate, format = &quot;%Y-%m-%d&quot;)]
tr[, arm := factor(arm)]
tr[, memstatus := factor(memstatus)]
tr[, assignment := factor(assignment)]
tr0 &lt;- tr[, .(gid, hhid, memstatus, assignment, arm, receivedCredit, elapsed, daysFromStart)]
table0(tr0[, .(memstatus, assignment)])
table0(tr0[, .(arm, assignment)])
table0(tr0[, .(memstatus, arm)])
tr1 &lt;- tr0[, -grep(&quot;Cre&quot;, colnames(tr0)), with = F]
@
\textsf{tr0} and \textsf{tr1} are based on the information at rd 3.
&lt;&lt;warning = F&gt;&gt;=
setwd(pathsave)
indate &lt;- fread(&quot;interview_dates_long.prn&quot;, integer64 = &quot;double&quot;)
indate[, intDate := as.POSIXct(intDate, format = &quot;%Y-%m-%d&quot;)]
indate[, daysSince2014 := 
    asn(intDate - as.POSIXct(&quot;2014-01-01&quot;, format = &quot;%Y-%m-%d&quot;))]
indate &lt;- reshape(indate, direction = &quot;wide&quot;, idvar = &quot;hhid&quot;,
    timevar = &quot;rd&quot;, 
    v.names = c(&quot;disbursed&quot;, &quot;purchased&quot;, &quot;intDate&quot;, &quot;daysSince2014&quot;))
@
Merge interview dates with treatment assignment info \textsf{tr1}.
&lt;&lt;&gt;&gt;=
setkey(indate, hhid); setkey(tr0, hhid); setkey(tr1, hhid)
tr0 &lt;- indate[tr0]
tr1 &lt;- indate[tr1]
&lt;&lt;&gt;&gt;=
tr1l &lt;- reshape(tr1, direction = &quot;long&quot;, idvar = c(&quot;gid&quot;, &quot;hhid&quot;, 
    &quot;assignment&quot;, &quot;arm&quot;, &quot;memstatus&quot;), varying = grepout(&quot;\\.\\d&quot;, colnames(tr0)))
setnames(tr1l, &quot;time&quot;, &quot;rd&quot;); setkey(tr1l, hhid, rd)
table(tr1l[ ,.(rd, disbursed, assignment)], useNA = &quot;ifany&quot;)
table(tr1l[ ,.(rd, disbursed, memstatus)], useNA = &quot;ifany&quot;)
@


\section{Food consumption (23B in rd 1, 3B in rds 2, 3)}

&lt;&lt;echo = F, results = &#39;hide&#39;&gt;&gt;=
setwd(pathsource.mar)
foldername &lt;- list.dirs(path = &quot;.&quot;, recursive = T, full.names = T)
foldername &lt;- foldername[!grepl(&quot;add|ori|^\\.$|1$&quot;, foldername)]
fn &lt;- unique(list.files(path = foldername, pattern = &quot;.prn$&quot;, 
    recursive = T, full.names = T))
&lt;&lt;&gt;&gt;=
setwd(pathsource.mar)
grepout(&quot;sect.*\\_3b|23b_m|23b.prn&quot;, fn)
sec3b = copy(X[grep(&quot;sect.*\\_3b|23b_m|23b.prn&quot;, fn)])
setnames(sec3b[[2]], &quot;id&quot;, &quot;hhid&quot;)
setnames(sec3b[[3]], &quot;id&quot;, &quot;hhid&quot;)
@
There is pure duplication in rd 1 files. Drop them.
&lt;&lt;&gt;&gt;=
lapply(sec3b[1], 
    function(x) x[hhid %in% x[duplicated(x[, .(hhid, mid)]), hhid], ])
sec3b[1] &lt;- lapply(sec3b[1], 
    function(x) x[!duplicated(x[, .(hhid, mid)]), ])
sec3b[[2]] &lt;- sec3b[[2]][!duplicated(hhid), ]
asl(lapply(sec3b[1], 
    function(x) any(duplicated(x[, .(hhid, mid)]))))
@
There is only one HH that reports food intake of a non-head member. I will drop this non-head member.
&lt;&lt;&gt;&gt;=
table0(sec3b[[1]][!is.na(s23b_1), mid])
sec3b[[1]][hhid %in% hhid[!is.na(s23b_1) &amp; mid != 1], ]
# drop all non-head members
sec3b[[1]] &lt;- sec3b[[1]][mid == 1, ]
@
Drop hhid = NA.
&lt;&lt;&gt;&gt;=
sec3b &lt;- lapply(sec3b, function(x) x[!is.na(hhid), ])
@
Merge treatment assignment info.
&lt;&lt;results = &#39;hide&#39;&gt;&gt;=
invisible(lapply(sec3b, setkey, hhid)); setkey(tr0, hhid)
sec3b &lt;- lapply(sec3b, merge, tr0, by = &quot;hhid&quot;, all.x = T)
@
Some \textsf{gid}s are missing in sec3b. Check if the merge is done correctly. Check if this is due to hhid = 980... cases. Strip leading 980/990 and see if the matched observations have variables originally from \textsf{tr0}.
&lt;&lt;&gt;&gt;=
nahhids &lt;- lapply(sec3b, function(x) asn(unique(x[is.na(gid), hhid])))
nahhids &lt;- lapply(nahhids, gsub, pattern = &quot;^980|^990&quot;, replacement = &quot;&quot;)
nahhids &lt;- lapply(nahhids, asn)
table0(sec3b[[1]][hhid %in% nahhids[[1]], assignment])
table0(sec3b[[2]][hhid %in% nahhids[[2]], assignment])
table0(sec3b[[3]][hhid %in% nahhids[[3]], assignment])
@
Rd 1 seems to be merged OK. Rd 2, 3 show that there are duplicated \textsf{hhid} so drop all entries with duplication.
&lt;&lt;&gt;&gt;=
sec3b[[2]] &lt;- sec3b[[2]][!(hhid %in% nahhids[[2]]), ]
sec3b[[3]] &lt;- sec3b[[3]][!(hhid %in% nahhids[[3]]), ]
@
There still remains unmatched observations as seen in NAs in \textsf{assignment} (found in Sec 3B files but not in identification files.) We drop these observations.
&lt;&lt;&gt;&gt;=
lapply(sec3b, function(x) table0(x[is.na(gid), assignment]))
sec3b &lt;- lapply(sec3b, function(x) x[!is.na(gid), ])
asn(lapply(sec3b, dim))
&lt;&lt;echo = F, eval = F&gt;&gt;=
for (i in 1:3) {
    sec3b[[i]][, gid2 := substr(asc(hhid), 1, nchar(asc(hhid))-2)]
    sec3b[[i]][, gid2 := gsub(&quot;^9.0&quot;, &quot;&quot;, gid2)]
    if ((nn &lt;- nrow(sec3b[[i]][is.na(gid) &amp; !is.na(gid2), ])) &gt; 0) {
        print(paste0(&quot;Rd &quot;, i, &quot;: Supplement &quot;, nn, &quot; gid from hhid.&quot;), quote = F)
        sec3b[[i]][, gid := asn(gid2)]
    }
    sec3b[[i]][, gid2 := NULL]
}
@

    Three meals. In rd 1, we ask for all the members about the number of times they eat meals, during monga and off-monga seasons. On average, there is only 1 out of \Sexpr{round(nrow(sec3b[[1]])/sum(!is.na(sec3b[[1]][, s23b_1])), 1)} HH members reponding to the question, which are all HH head members. In rds 2 and 3, we ask a blanket question if all the members eat three times a day for the whole year. So rd 1 question is more likely to be responded as ``3 times&#39;&#39; than in rd 2, 3 questions, \textit{cetris paribus}. So observing more ``3 times&#39;&#39; responses in the latter rds indicate that there may be improvements in household food intake. 

%Duplication of \textsf{hhid} in ``original&#39;&#39; and ``additional&#39;&#39; samples. In close inspection, I find that 9808148207 is in between 8148206 and 8148208 in original sample file. I will drop leading 980 from 9808148207 as there is no 8148207 in both files. Same is true for 9808148220 where I change to 8148220 in the original file.
&lt;&lt;echo = F, eval = F, results = &#39;hide&#39;&gt;&gt;=
table(tb &lt;- table0(sec3b[[1]][, .(hhid, mid)]))
(hhid.dup &lt;- tb[apply(tb == 2, 1, any), ])
if (length(hhid.dup) &gt; 0) sec3b[[1]][hhid %in% rownames(hhid.dup), ]
sec3b[[2]][hhid == 9808148207, hhid := 8148207]
sec3b[[2]][hhid == 9808148220, hhid := 8148220]
@
Combine rd 1 original and additional into a single file, then put into a list with rds 2, 3.
&lt;&lt;&gt;&gt;=
meal3.0 &lt;- c(asn(table0(grepl(&quot;3&quot;, sec3b[[1]][, s23b_1]) &amp; grepl(&quot;3&quot;, sec3b[[1]][, s23b_2]) &amp; 
    grepl(&quot;3&quot;, sec3b[[1]][, s23b_5]) &amp; grepl(&quot;3&quot;, sec3b[[1]][, s23b_6]))),
    asn(lapply(sec3b[2:3], function(x) table0(grepl(&quot;y&quot;, x[, s8bq1])))))
# leave monga out
meal3 &lt;- c(asn(table0(grepl(&quot;3&quot;, sec3b[[1]][, s23b_1]) &amp; grepl(&quot;3&quot;, sec3b[[1]][, s23b_2]))),
    asn(lapply(sec3b[2:3], function(x) table0(grepl(&quot;y&quot;, x[, s8bq1])))))
meal3 &lt;- matrix(meal3, byrow = T, ncol = 2)
dimnames(meal3) &lt;- list(paste0(&quot;rd&quot;, 1:3), c(&quot;FALSE&quot;, &quot;TRUE&quot;))
meal3
iiD1 &lt;- sec3b[[1]][, receivedCredit]
iiD2 &lt;- sec3b[[2]][, receivedCredit]
iiD3 &lt;- sec3b[[3]][, receivedCredit]
iiI1 &lt;- grepl(&quot;treated&quot;, sec3b[[1]][, assignment])
iiI2 &lt;- grepl(&quot;treated&quot;, sec3b[[2]][, assignment])
iiI3 &lt;- grepl(&quot;treated&quot;, sec3b[[3]][, assignment])
meal3D1 &lt;- 
    c(asn(table0(grepl(&quot;3&quot;, sec3b[[1]][iiD1, s23b_1]) &amp; grepl(&quot;3&quot;, sec3b[[1]][iiD1, s23b_2]))),
    asn(table0(grepl(&quot;y&quot;, sec3b[[2]][iiD2, s8bq1]))),
    asn(table0(grepl(&quot;y&quot;, sec3b[[3]][iiD3, s8bq1]))))
meal3D0 &lt;- 
    c(asn(table0(grepl(&quot;3&quot;, sec3b[[1]][!iiD1, s23b_1]) &amp; grepl(&quot;3&quot;, sec3b[[1]][!iiD1, s23b_2]))),
    asn(table0(grepl(&quot;y&quot;, sec3b[[2]][!iiD2, s8bq1]))),
    asn(table0(grepl(&quot;y&quot;, sec3b[[3]][!iiD3, s8bq1]))))
meal3I1 &lt;- 
    c(asn(table0(grepl(&quot;3&quot;, sec3b[[1]][iiI1, s23b_1]) &amp; grepl(&quot;3&quot;, sec3b[[1]][iiI1, s23b_2]))),
    asn(table0(grepl(&quot;y&quot;, sec3b[[2]][iiI2, s8bq1]))),
    asn(table0(grepl(&quot;y&quot;, sec3b[[3]][iiI3, s8bq1]))))
meal3I0 &lt;- 
    c(asn(table0(grepl(&quot;3&quot;, sec3b[[1]][!iiI1, s23b_1]) &amp; grepl(&quot;3&quot;, sec3b[[1]][!iiI1, s23b_2]))),
    asn(table0(grepl(&quot;y&quot;, sec3b[[2]][!iiI2, s8bq1]))),
    asn(table0(grepl(&quot;y&quot;, sec3b[[3]][!iiI3, s8bq1]))))
meal3D1 &lt;- matrix(meal3D1, byrow = T, ncol = 2)
meal3D0 &lt;- matrix(meal3D0, byrow = T, ncol = 2)
meal3I1 &lt;- matrix(meal3I1, byrow = T, ncol = 2)
meal3I0 &lt;- matrix(meal3I0, byrow = T, ncol = 2)
dimnames(meal3D1) &lt;- dimnames(meal3D0) &lt;- 
dimnames(meal3I1) &lt;- dimnames(meal3I0) &lt;- 
    list(paste0(&quot;rd&quot;, 1:3), c(&quot;FALSE&quot;, &quot;TRUE&quot;))
meal3DI &lt;- data.table(rbind(repseq(c(&quot;D=1&quot;, &quot;D=0&quot;, &quot;I=1&quot;, &quot;I=0&quot;), 2), 
    cbind(meal3D1, meal3D0, meal3I1, meal3I0)))
meal3DI
#z.0 &lt;- parse(text = &quot;s8bq&quot;)
#sec3b[[1]][, zval := eval(z.0)]
@
&lt;&lt;echo = F, results = &#39;markup&#39;, fig.align=&#39;center&#39;, fig.height = 2, fig.width = 4, fig.cap = &quot;3 meals per day&quot;, fig.lp = &#39;Figure&#39;&gt;&gt;=
ml3 &lt;-  cbind(meal3D1, meal3D0, meal3I1, meal3I0)
colnames(ml3) &lt;- paste0(repseq(c(&quot;D1&quot;, &quot;D0&quot;, &quot;I1&quot;, &quot;I0&quot;), 2), c(&quot;n&quot;, &quot;y&quot;))
ml3 &lt;- ml3r &lt;- data.table(ml3)
ml3r[, c(&quot;D1y&quot;, &quot;D1n&quot;) := list(D1y/(D1y+D1n), D1n/(D1y+D1n))]
ml3r[, c(&quot;D0y&quot;, &quot;D0n&quot;) := list(D0y/(D0y+D0n), D0n/(D0y+D0n))]
ml3r[, c(&quot;I1y&quot;, &quot;I1n&quot;) := list(I1y/(I1y+I1n), I1n/(I1y+I1n))]
ml3r[, c(&quot;I0y&quot;, &quot;I0n&quot;) := list(I0y/(I0y+I0n), I0n/(I0y+I0n))]
ml3r &lt;- ml3r[, grepout(&quot;y&quot;, colnames(ml3r)), with = F]
ml3r &lt;- data.table(repseq(c(&quot;actual&quot;, &quot;intention&quot;), 6),
    rep(rep(c(&quot;treated&quot;, &quot;control&quot;), 3), 2),
    1:3, asn(ml3r))
setnames(ml3r, colnames(ml3r), c(&quot;policy&quot;, &quot;status&quot;, &quot;rd&quot;, &quot;value&quot;))
library(ggplot2)
ggplot(data = ml3r, aes(x = rd, y = value)) + 
    geom_point(aes(color = status, shape = status), size = 1.5) +
    geom_line(aes(color = status), size = .5) +
    ylab(&quot;rate&quot;) + xlab(&quot;Round&quot;) +
    scale_x_continuous(breaks=1:3) +
    facet_wrap(~ policy) +
    theme(axis.title.y = element_text(size = rel(.25), angle = 90), 
        axis.title.x = element_text(size = rel(.25), angle = 0),
        axis.text.x = element_text(size = rel(.5)),
        axis.text.y = element_text(size = rel(.5), angle = 0),
        legend.text = element_text(size=rel(.5)), 
        legend.position = &quot;bottom&quot;, 
        legend.title = element_text(size=rel(.5)),
        strip.text = element_text(size=rel(.25)),
        strip.text.x = element_text(margin = margin(.05, 0, .05, 0, &quot;cm&quot;)))
@
Given the questions are different, it is not surprising that we have different proportion of subjects with three meals per day. Despite this limitation, we have an increasing food consumption security which is promissing.

Form data for regression.
&lt;&lt;&gt;&gt;=
s3b &lt;- merge(sec3b[[1]][, .(gid, hhid, s23b_1, s23b_2, arm, assignment, 
    disbursed.1, purchased.1, receivedCredit, 
    daysFromStart, daysSince2014.1, intDate.1)],
    sec3b[[2]][, .(gid, hhid, s8bq1, arm, assignment, 
    disbursed.2, purchased.2, receivedCredit, daysSince2014.2, intDate.2)], 
    by = c(&quot;gid&quot;, &quot;hhid&quot;, &quot;arm&quot;, &quot;assignment&quot;), all = T, , suffixes = c(&quot;.1&quot;, &quot;.2&quot;))
s3b &lt;- merge(s3b, sec3b[[3]][, .(gid, hhid, s8bq1, arm, assignment, 
    disbursed.3, purchased.3, receivedCredit, daysSince2014.3, intDate.3)], 
    by = c(&quot;gid&quot;, &quot;hhid&quot;, &quot;arm&quot;, &quot;assignment&quot;), all = T, suffixes = c(&quot;.2&quot;, &quot;.3&quot;))
setnames(s3b, &quot;receivedCredit&quot;, &quot;receivedCredit.3&quot;)
dim(s3b); dim(s3b &lt;- s3b[!is.na(hhid) | !is.na(gid), ])
s3b[, c(&quot;disbursed.1&quot;, &quot;purchased.1&quot;, &quot;receivedCredit.1&quot;) := F]
if (nrow(s3b[is.na(assignment), ]) &gt; 0) 
    s3b[is.na(assignment), assignment := &quot;drop out&quot;]
dim(s3b &lt;- s3b[!duplicated(s3b), ])
@
3 meals per day in regular times for rd 1. For rd 2, 3, yes to the question.
&lt;&lt;&gt;&gt;=
s3b[, c(&quot;m3.1&quot;, &quot;m3.2&quot;, &quot;m3.3&quot;) := 
    list(grepl(&quot;3&quot;, s3b[, s23b_1]) &amp; grepl(&quot;3&quot;, s3b[, s23b_2]),
    grepl(&quot;y&quot;, s3b[, s8bq1.2]),
    grepl(&quot;y&quot;, s3b[, s8bq1.3]))]
s3b[is.na(s23b_1) | is.na(s23b_2), m3.1 := NA]
s3b[is.na(s3b[, s8bq1.2]), m3.2 := NA]
s3b[is.na(s3b[, s8bq1.3]), m3.3 := NA]
@
Rescale days by 100. Note that \textsf{assignment} has empty observations who either group rejected or lost to flood. They form the reference group for \textsf{assignment (control, treated)}. 
&lt;&lt;cache = F&gt;&gt;=
s3b[, daysFromStart := daysFromStart/100]
dim(s3b &lt;- s3b[, !grepl(&quot;^s\\d&quot;, colnames(s3b)), with = F])
#s3bl &lt;- reshape(s3b, direction = &quot;long&quot;, 
#   idvar = c(&quot;gid&quot;, &quot;hhid&quot;, &quot;assignment&quot;, &quot;arm&quot;),
#   varying = grepout(&quot;\\.\\d&quot;, colnames(s3b)))
dim(s3b.comp &lt;- s3b[!is.na(m3.2) &amp; !is.na(m3.3) &amp; 
    !is.na(receivedCredit.2) &amp; !is.na(receivedCredit.3), ])
s3bl &lt;- reshape(s3b.comp, direction = &quot;long&quot;, 
    idvar = c(&quot;gid&quot;, &quot;hhid&quot;, &quot;assignment&quot;, &quot;arm&quot;),
    varying = grepout(&quot;\\.\\d&quot;, colnames(s3b.comp)))
m3data &lt;- s3bl[time &gt; 1, ]
setkey(m3data, hhid, time)
table(table(m3data[, hhid]))
m3data[, m3 := m3+0]
m3data[, arm := factor(arm, levels = c(&quot;traditional&quot;, &quot;large&quot;, &quot;large grace&quot;, &quot;cow&quot;, &quot;lost to flood&quot;))]
m3data[, assigncredit := grepl(&quot;tre&quot;, assignment) * receivedCredit]
@
\textsf{m3data}: Rd 2-3 data on three meals per day. 
&lt;&lt;&gt;&gt;=
dm3 &lt;- data.table(m3data[seq(1, nrow(m3data), 2), 
    .(gid, arm, assignment, receivedCredit, assigncredit, daysFromStart)],
    m3data[seq(2, nrow(m3data), 2), .(disbursed, purchased, daysSince2014, m3)]-
    m3data[seq(1, nrow(m3data), 2), .(disbursed, purchased, daysSince2014, m3)])
l1 &lt;- glm(m3 ~ arm, data = dm3)
l2 &lt;- glm(m3 ~ assignment, data = dm3)
l3 &lt;- glm(m3 ~ arm*disbursed, data = dm3)
l4 &lt;- glm(m3 ~ assignment + disbursed + assigncredit, data = dm3)
l5 &lt;- glm(m3 ~ arm + daysFromStart, data = dm3)
l6 &lt;- glm(m3 ~ arm*disbursed + daysFromStart, data = dm3)
#p1 &lt;- glm(m3 ~ arm, family=binomial(link=&quot;probit&quot;), data = m3data)
linprob &lt;- list(l1, l2, l3, l4, l5, l6)
linest &lt;- lapply(linprob, clx.regobj, Cluster = &quot;gid&quot;)
linest &lt;- lapply(linest, function(x) x[, -3])
linest &lt;- tabs2latex(linest)
R2 &lt;- round(asn(lapply(linprob, 
    function(x) 1-crossprod(summary(x)$deviance.res)/summary(x)$null.dev)), 3)
en &lt;- asn(lapply(linprob, function(x) length(x$y)))
rn &lt;- rownames(linest)
rn &lt;- gsub(&quot;arm|assignment|^se.*&quot;, &quot;&quot;, rn)
rn &lt;- gsub(&quot;assigncredit&quot;, &quot;treated * credit&quot;, rn)
rn &lt;- gsub(&quot;disbursed&quot;, &quot;credit&quot;, rn)
rn &lt;- gsub(&quot;:&quot;, &quot; * &quot;, rn)
rn &lt;- gsub(&quot;daysFromStart&quot;, &quot;elapsed days * 100&quot;, rn)
ltab &lt;- rbind(as.matrix(cbind(rn, linest)), c(&quot;$R^{2}$&quot;, R2), 
    c(&quot;$n$&quot;, en))
write.tablev(latextab(ltab, delimiterline = NULL, alternatecolor2 = &quot;gray90&quot;,
    hleft = c(&quot;\\footnotesize&quot;, rep(&quot;\\scriptsize\\hfil$&quot;, ncol(ltab)-1)),
    hcenter = c(2.2, rep(1.25, ncol(ltab)-1)), 
    hright = c(&quot;\\hfill&quot;, rep(&quot;$&quot;, ncol(ltab)-1)),
    adjustlineskip = &quot;-.4ex&quot;), 
    paste0(pathsave, &quot;3meals.tex&quot;), colnamestrue = F)
@

\begin{table}
%\hspace{-2em}\begin{minipage}[t]{9cm}
\hfil\textsc{\footnotesize Table \refstepcounter{table}\thetable: FD estimates of three meals per day, round 2, 3\label{FD3meals}}\\
\setlength{\tabcolsep}{1pt}
\renewcommand{\arraystretch}{.6}
\hfil\begin{tikzpicture}
\node (tbl) {\input{c:/data/GUK/analysis/save/3meals.tex}};
\input{c:/data/GUK/analysis/program/tablecolortemplate_top_1row.tex}
\end{tikzpicture}\\
\renewcommand{\arraystretch}{1}

\vspace{-4ex}
\hfil\begin{tabular}{&gt;{\hfill\scriptsize}p{1cm}&lt;{}&gt;{\hfill\scriptsize}p{.25cm}&lt;{}&gt;{\scriptsize}p{11.5cm}&lt;{\hfill}}
Notes:&amp; 1. &amp; First-difference estimates of having three meals per day using rd 2 and 3 information. Standard errors are clustered at the group level.\\[-1ex]
&amp; 2. &amp; \textsf{large, large grace, cow, lost to flood, control, treated, credit} are all time invariant and are interacted with a trend term. 
Regressions (1) - (4) include subjects who group-rejected or lost to flood as a reference group. Regressions (5) - (6) drop subjects who group-rejected or lost to flood and use the subjects who were initially assigned to the control as a reference group.\\
&amp; 3. &amp; $*$, $**$, $***$ indicate significance levels at 10\%, 5\%, 1\%, respectively.\\
\end{tabular}
%\end{minipage}
\end{table}

We see no impacts of intervention when comparing two perids after the disbursement. 

\section{Credit use}

&lt;&lt;&gt;&gt;=
cruse.files &lt;- grepout(&quot;21&quot;, fn)
cruse.files &lt;- cruse.files[!grepl(&quot;com&quot;, cruse.files)]
@
File names of rd 3 files are named for the page ordering. For example, \textsf{\footnotesize\Sexpr{gsub(&quot;\\_&quot;, &quot;\\\\_&quot;, cruse.files[1])}} are the first 2 questions of Section 20, which is named as 21 as it is an unnumbered page that comes right after Section 20. \textsf{\footnotesize\Sexpr{gsub(&quot;\\_&quot;, &quot;\\\\_&quot;, fn[80])}} is Section 18.
&lt;&lt;&gt;&gt;=
setwd(pathsource.mar)
fread(cruse.files[1], integer64 = &quot;double&quot;)
fn21 &lt;- grepout(&quot;2/section_23.prn|3/section_21&quot;, fn)
@
In rd 2, Section 21 is stored under \textsf{\footnotesize\Sexpr{gsub(&quot;\\_&quot;, &quot;\\\\_&quot;, fn21[1])}}, in rd 3, \textsf{\footnotesize\Sexpr{gsub(&quot;\\_&quot;, &quot;\\\\_&quot;, fn21[-1])}}.
&lt;&lt;warning = F&gt;&gt;=
setwd(pathsource.mar)
foldername &lt;- list.dirs(path = &quot;.&quot;, recursive = T, full.names = T)
foldername &lt;- foldername[!grepl(&quot;add|ori|^\\.$|1$&quot;, foldername)]
fn &lt;- unique(list.files(path = foldername, pattern = &quot;.prn$&quot;, 
    recursive = T, full.names = T))
X = lapply(fn, fread, integer64 = &quot;double&quot;)
&lt;&lt;&gt;&gt;=
Cr = copy(X[fn %in% fn21])
Cr &lt;- lapply(Cr, function(x) if (any(grepl(&quot;^id$&quot;, colnames(x)))) 
    setnames(x, &quot;id&quot;, &quot;hhid&quot;) else x)
invisible(lapply(Cr, setkey, hhid))
Cr2 &lt;- Cr[[1]]
setnames(Cr2, colnames(Cr2)[-1],
    paste0(&quot;V&quot;, 1:(ncol(Cr2)-1), &quot;_&quot;, colnames(Cr2)[-1]))
setnames(Cr2, colnames(Cr2), 
    gsub(&quot;seca3_&quot;, &quot;&quot;, colnames(Cr2)))
setnames(Cr2, colnames(Cr2), 
    gsub(&quot;_\\d_|_q\\d_|__&quot;, &quot;_&quot;, colnames(Cr2)))
setnames(Cr2, colnames(Cr2), 
    gsub(&quot;_\\d_&quot;, &quot;_&quot;, colnames(Cr2)))
Cr3 &lt;- Cr[[2]][Cr[[3]]]
setnames(Cr3, colnames(Cr3)[-1],
    paste0(&quot;V&quot;, 1:(ncol(Cr3)-1), &quot;_&quot;, colnames(Cr3)[-1]))
setnames(Cr3, colnames(Cr3), 
    gsub(&quot;_q.*?_([a-z])&quot;, &quot;_\\1&quot;, colnames(Cr3)))
setnames(Cr3, colnames(Cr3), 
    gsub(&quot;_a_&quot;, &quot;_&quot;, colnames(Cr3)))
Cr3 &lt;- Cr3[!is.na(hhid), ]
setkey(Cr3, hhid, V5_from_when_you_started_1, 
    V6_from_when_you_started_2)
#setnames(Cr3, colnames(Cr3)[-1], 
#   paste0(&quot;V&quot;, putzeroontop(1:(ncol(Cr3)-1), totaldigits = 2)))
Cr3[, iga := 1:.N, by = hhid]
Cr3[, igas := .N, by = hhid]
setkey(Cr3, hhid, iga)
@
Merge rd 2 and 3.
&lt;&lt;&gt;&gt;=
setnames(Cr2, grepout(&quot;from.oth&quot;, colnames(Cr2)), &quot;loanFromOther&quot;)
setnames(Cr3, grepout(&quot;from.oth&quot;, colnames(Cr3)), &quot;loanFromOther&quot;)
setnames(Cr3, grepout(&quot;deta.*j$&quot;, colnames(Cr3)), &quot;igaContent&quot;)
setnames(Cr3, grepout(&quot;deta.*i$&quot;, colnames(Cr3)), &quot;specify&quot;)
setnames(Cr3, grepout(&quot;am.*ed&quot;, colnames(Cr3)), &quot;investValue&quot;)
setnames(Cr3, grepout(&quot;start.*_1&quot;, colnames(Cr3)), &quot;startY&quot;)
setnames(Cr3, grepout(&quot;start.*_2&quot;, colnames(Cr3)), &quot;startM&quot;)
setnames(Cr3, grepout(&quot;du&quot;, colnames(Cr3)), &quot;investDuration&quot;)
setnames(Cr3, grepout(&quot;8.*othe.*g&quot;, colnames(Cr3)), &quot;investSame&quot;)
setnames(Cr3, grepout(&quot;9.how.*&quot;, colnames(Cr3)), &quot;investSameNum&quot;)
setnames(Cr3, grepout(&quot;0.*any.*g&quot;, colnames(Cr3)), &quot;investSameExper&quot;)
setnames(Cr3, grepout(&quot;1.how.*&quot;, colnames(Cr3)), &quot;investSameExperNum&quot;)
setnames(Cr3, grepout(&quot;2.*still&quot;, colnames(Cr3)), &quot;investSameStill&quot;)
Cr2 &lt;- Cr2[!is.na(hhid), ]
Cr3 &lt;- Cr3[!is.na(hhid), ]
lapply(list(Cr2, Cr3), colnames)
setwd(pathsave)
write.tablev(Cr2, &quot;credit_use_rd_2.prn&quot;)
write.tablev(Cr3, &quot;credit_use_rd_2.prn&quot;)
@

Intended use of credit, mostly livestock (cows).
&lt;&lt;echo = F, results = &#39;markup&#39;, fig.align=&#39;center&#39;, fig.height = 2, fig.width = 3, fig.cap = &quot;Stated use of credit in rd 2&quot;, fig.lp = &#39;Figure&#39;&gt;&gt;=
tb &lt;- table(Cr2[, grep(&quot;use1&quot;, colnames(Cr2)), with = F])
tb &lt;- data.table(tb)
setnames(tb, colnames(tb), c(&quot;use&quot;, &quot;freq&quot;))
tb &lt;- tb[use != &quot;&quot;, ]
library(ggplot2)
ggplot(data = tb, aes(x = use, y = freq)) +
    geom_bar(stat= &quot;identity&quot;, fill = &quot;blue&quot;) +
#    coord_flip() +
    ylab(&quot;Frequency&quot;) + xlab(&quot;Stated use of credit&quot;) +
    scale_fill_manual(values = &quot;white&quot;, labels = &quot;control&quot;) +
    theme(axis.title.y = element_text(size = rel(.25), angle = 90), 
        axis.title.x = element_text(size = rel(.25), angle = 0),
        axis.text.x = element_text(size = rel(.5), angle = 30, hjust = 1),
        axis.text.y = element_text(size = rel(.5), angle = 0))
@
It is interesting to note that the majority of our subjects choose livestock for an investment. 

Work hours.
&lt;&lt;echo = F, results = &#39;markup&#39;, fig.align=&#39;center&#39;, fig.height = 2, fig.width = 3, fig.cap = &quot;Work hours&quot;, fig.lp = &#39;Figure&#39;&gt;&gt;=
tb &lt;- table(Cr2[, grep(&quot;word_h&quot;, colnames(Cr2)), with = F])
tb &lt;- data.table(tb)
setnames(tb, colnames(tb), c(&quot;hours&quot;, &quot;freq&quot;))
tb &lt;- tb[hours != &quot;&quot;, ]
library(ggplot2)
ggplot(data = tb, aes(x = hours, y = freq)) +
    geom_bar(stat= &quot;identity&quot;, fill = &quot;blue&quot;) +
#    coord_flip() +
    ylab(&quot;Frequency&quot;) + xlab(&quot;Changes in own work hours since receiving a loan&quot;) +
    theme(axis.title.y = element_text(size = rel(.25), angle = 90), 
        axis.title.x = element_text(size = rel(.25), angle = 0),
        axis.text.x = element_text(size = rel(.5), angle = 0, hjust = .5),
        axis.text.y = element_text(size = rel(.5), angle = 0))
@

\section{New loans}

Loans in rds 1, 2, and 3.
&lt;&lt;&gt;&gt;=
(fn20c &lt;- grepout(&quot;2/s.*20c|3/s.*19c&quot;, fn))
(fn19.1 &lt;- grepout(&quot;d/s.*19&quot;, fn))
bo1 = copy(X[[which(fn %in% fn19.1)]])
bo1 &lt;- bo1[!is.na(s19_1_1), ]
bo1 &lt;- bo1[!duplicated(hhid), ]
lendersin1 &lt;- c(&quot;other&quot;, &quot;relative&quot;, &quot;moneylender&quot;)
setnames(bo1, paste0(&quot;s19_&quot;, repseq(1:3, 5), &quot;_&quot;, rep(1:5, 3)),
    paste0(c(&quot;ask&quot;, &quot;askAmount&quot;, &quot;cashAmount&quot;, &quot;interest&quot;, &quot;usage&quot;), &quot;.&quot;, 
    repseq(lendersin1, 5)))
bo1l &lt;- reshape(bo1, direction = &quot;long&quot;, idvar = &quot;hhid&quot;,
    varying = grepout(&quot;\\.&quot;, colnames(bo1)))
setnames(bo1l, &quot;time&quot;, &quot;lender&quot;)
setkey(bo1l, hhid, lender)
bo1l[, totalSum := sum(cashAmount, na.rm = T), by = hhid]
bo1l[grepl(&quot;oth&quot;, lender), lender := &quot;other NGO/MFI&quot;]
bo1l[grepl(&quot;rel&quot;, lender), lender := &quot;friends, relatives&quot;]
bo1l[grepl(&quot;mo&quot;, lender), lender := &quot;money lenders&quot;]
Bo1 &lt;- cbind(rd = 1, bo1l)
@
In rd 1, there are only 14 subjects who have borrowed from \textsf{other NGO/MFI} in the last 12 months. Most of the loans are taken from \textsf{friends, relatives} and \textsf{money lenders}, for about 9\%, 13\% of subjects, respectively.
&lt;&lt;&gt;&gt;=
bor1 &lt;- by(bo1l[, cashAmount], bo1l[, lender], destat)
bor1des &lt;- data.frame(rbindlist(lapply(bor1, function(x) data.table(t(matrix(x))))))
dimnames(bor1des) &lt;- list(names(bor1), colnames(bor1[[1]]))
bor1des
@

&lt;&lt;&gt;&gt;=
Bo = copy(X[fn %in% fn20c])
Bo &lt;- lapply(Bo, function(x) if (any(grepl(&quot;^id$&quot;, colnames(x)))) 
    setnames(x, &quot;id&quot;, &quot;hhid&quot;) else x)
invisible(lapply(Bo, setkey, hhid))
Bo &lt;- rbindlist(list(data.table(rd = 2, Bo[[1]]), data.table(rd = 3, Bo[[2]])))
Bo &lt;- Bo[!is.na(hhid), ]
Bo[, bo := 1:.N, by = c(&quot;hhid&quot;, &quot;rd&quot;)]
setkey(Bo, hhid, rd, bo)
Bo[, inkindAmount := (in_kind_amount_4_1) * (in_kind_price_4_1)]
Bo[is.na(inkindAmount), inkindAmount := 0]
Bo[is.na(cash_tk_4_1), cash_tk_4_1 := 0]
Bo[, cashAmount := cash_tk_4_1]
Bo[, totalSum := sum(cashAmount+inkindAmount), by = c(&quot;hhid&quot;, &quot;rd&quot;)]
Bo[, purpose := pur_loan_4_1]
Bo[grepl(&quot;other&quot;, purpose), purpose := purpose_of_the_loan_specify_4_1]
Bo[grepl(&quot;cow|COW|cuw|cou ?bu|cow ?bu|cwo|gow|cokw|coe|coy|ci=ow&quot;, purpose), 
    purpose := &quot;buying cows&quot;]
Bo[grepl(&quot;goa?t|goad|goot&quot;, purpose), purpose := &quot;buying goats&quot;]
Bo[grepl(&quot;shee|shepp&quot;, purpose), purpose := &quot;buying sheep&quot;]
Bo[grepl(&quot;boa?t|boad|ship&quot;, purpose), purpose := &quot;buying a boat&quot;]
Bo[grepl(&quot;land|lond|lnad&quot;, purpose), purpose := &quot;buy/leasing in land&quot;]
Bo[grepl(&quot;house&quot;, purpose), purpose := &quot;buying a house&quot;]
Bo[grepl(&quot;eremny|dowry&quot;, purpose), purpose := &quot;ceremony, dowry&quot;]
Bo[grepl(&quot;mach&quot;, purpose), purpose := &quot;buying machines&quot;]
Bo[grepl(&quot;buss?inn?es|trade&quot;, purpose), purpose := &quot;business investment&quot;]
table0(Bo[, loan_taken_from_4_1])
Bo[, lender := tolower(loan_taken_from_4_1)]
Bo[grepl(&quot;rela&quot;, lender), lender := &quot;friends, relatives&quot;]
Bo[grepl(&quot;mo&quot;, lender), lender := &quot;money lenders&quot;]
Bo[grepl(&quot;0&quot;, lender), lender := &quot;&quot;]
Bo[lender == &quot;&quot;, lender := NA]
Bo[grepl(&quot;sho|tr&quot;, lender), lender := &quot;shop owners, traders&quot;]
Bo[grepl(&quot;gra|other|co-|ban&quot;, lender) | grepl(&quot;bra&quot;, loan_taken_from_specify_4_1), 
    lender := &quot;other NGO/MFI&quot;]
Bo[grepl(&quot;GUK|guk|ugk&quot;, loan_taken_from_specify_4_1), lender := &quot;GUK&quot;]
table0(Bo[, lender])
table0(Bo[grepl(&quot;other&quot;, lender), loan_taken_from_specify_4_1])
table0(Bo[grepl(&quot;other&quot;, lender), cashAmount])
@
Append rd 1.
&lt;&lt;&gt;&gt;=
setkey(Bo, hhid, rd); setkey(Bo1, hhid, rd)
Bo13 &lt;- rbind(Bo1, Bo, fill = T)
setkey(Bo13, hhid, rd, lender)
@
Merge treatment info.
&lt;&lt;&gt;&gt;=
tr0l &lt;- reshape(tr0, direction = &quot;long&quot;, 
    idvar = c(&quot;gid&quot;, &quot;hhid&quot;, &quot;memstatus&quot;, &quot;assignment&quot;, &quot;arm&quot;),
    varying = grepout(&quot;\\.\\d&quot;, colnames(tr0)))
setnames(tr0l, &quot;time&quot;, &quot;rd&quot;)
setkey(Bo13, hhid, rd); setkey(tr0l, hhid, rd)
Bot &lt;- tr0l[Bo13]
by(Bot[grepl(&quot;other|G&quot;, lender), cashAmount], Bot[grepl(&quot;other|G&quot;, lender), rd], destat)
Bot[, combined.lender := lender]
Bot[grepl(&quot;oth|GU&quot;, lender), combined.lender := &quot;NGO/MFI&quot;]
Bot[grepl(&quot;shop&quot;, lender), combined.lender := &quot;money lenders&quot;]
setwd(pathsave)
write.tablev(Bot, &quot;borrowing_rd_1-3.prn&quot;)
@
Plot new loans in each rd. I will combine \textsf{shop owners/traders} with \textsf{money lenders}. I will also combine \textsf{GUK} and \textsf{other NGO/MFI} to \textsf{NGO/MFI}. We also omit zero borrowing from the histogram for clarity.
&lt;&lt;echo = F, warning = F, results = &#39;markup&#39;, fig.align=&#39;center&#39;, fig.height = 2, fig.width = 3, fig.cap = &quot;New loans&quot;, fig.lp = &#39;Figure&#39;&gt;&gt;=
#Bot[, totalSum0 := totalSum]
#Bot[totalSum == 0, totalSum0 := NA]
library(ggplot2)
ggplot(data = subset(Bot, cashAmount &gt; 0), aes(x = cashAmount, fill = combined.lender)) +
    geom_histogram(bins = 20) + 
    scale_x_continuous(limits = c(0, 30000)) +
    scale_y_continuous(limits = c(0, 1000)) +
    ylab(&quot;Frequency&quot;) + xlab(&quot;Borrowing (Tk)&quot;) + labs(fill = &quot;lenders&quot;) +
    facet_wrap(~ rd) + 
    theme(axis.title.y = element_text(size = rel(.25), angle = 90), 
        axis.title.x = element_text(size = rel(.25), angle = 0),
        axis.text.x = element_text(size = rel(.5), angle = 30, hjust = 1),
        axis.text.y = element_text(size = rel(.5), angle = 0),
        legend.text = element_text(size=rel(.25)), 
        legend.position = &quot;bottom&quot;, 
        legend.title = element_text(size = rel(.25)),
        legend.key = element_rect(size = rel(.25)),
        legend.key.size = unit(.15, &quot;cm&quot;),
        strip.text = element_text(size=rel(.5)),
        strip.text.x = element_text(margin = margin(.05, 0, .05, 0, &quot;cm&quot;)))
@
One can see that, in rd 1, there is virtually no borrowing from NGO/MFI among our subjects. This indicates that our study areas are relatively free from other non-indiginous financial intermediaries which allows us to estimate the impacts of our loans without much concerns of treatment contamination. In rd 2, borrowing from NGO/MFI increased rapidly as a result of our intervention. In rds 2 and 3, some individuals report smaller amount, which correspond to our traditional loan arm. It is hard to say that the loans from \textsf{friends, relatives} or \textsf{money lenders} have decreased after our intervetion between rd 1 and rd 2.


\section{Assets}


Read files.
&lt;&lt;&gt;&gt;=
(fn.asset &lt;- grepout(&quot;d/s.*14a|d/s.*14b|2/s.*15|3/s.*13&quot;, fn))
setwd(pathsource.mar)
As = copy(X[fn %in% fn.asset])
As &lt;- lapply(As, function(x) if (any(grepl(&quot;^id$&quot;, colnames(x)))) 
    setnames(x, &quot;id&quot;, &quot;hhid&quot;) else x)
As &lt;- lapply(As, function(x) x[!duplicated(x), ])
As &lt;- lapply(As, function(x) x[!is.na(hhid), ])
invisible(lapply(As, setkey, hhid))
invisible(lapply(As[1:2], setkey, hhid, mid))
@
Separate into rds for rd-specfic operations (to be merged back later).
&lt;&lt;&gt;&gt;=
As01 &lt;- As[[2]][As[[1]]]
As02 &lt;- As[3:4]
As03 &lt;- As[5:6]
@
Rd 1.
&lt;&lt;&gt;&gt;=
As11 &lt;- As01[, grepout(&quot;hhid|s14a&quot;, colnames(As01)), with = F]
setnames(As11, colnames(As11), 
    gsub(&quot;s14a_(\\d)_1$&quot;, &quot;item.\\1&quot;, colnames(As11)))
setnames(As11, colnames(As11), 
    gsub(&quot;s14a_(\\d)_2$&quot;, &quot;own.\\1&quot;, colnames(As11)))
setnames(As11, colnames(As11), 
    gsub(&quot;s14a_(\\d)_3$&quot;, &quot;value.\\1&quot;, colnames(As11)))
summary(As11[duplicated(As11), ])
As11[grepl(&quot;8207|8220|9416|212016&quot;, hhid) &amp; item.1 != &quot;&quot;, ]
As11[grepl(8207, hhid), item.2 := .SD[.N, item.1]]
As11[grepl(8207, hhid), own.2 := .SD[.N, own.1]]
As11[grepl(8207, hhid), value.2 := .SD[.N, value.1]]
As11[grepl(8220, hhid), item.2 := .SD[.N, item.1]]
As11[grepl(8220, hhid), own.2 := .SD[.N, own.1]]
As11[grepl(8220, hhid), value.2 := .SD[.N, value.1]]
As11 &lt;- As11[!duplicated(As11[, hhid]), ]
As12 &lt;- As01[, grepout(&quot;hhid|s14b&quot;, colnames(As01)), with = F]
setnames(As12, colnames(As12), 
    gsub(&quot;s14b_(\\d)_1$&quot;, &quot;item.\\1&quot;, colnames(As12)))
setnames(As12, colnames(As12), 
    gsub(&quot;s14b_(\\d)_2$&quot;, &quot;own.\\1&quot;, colnames(As12)))
setnames(As12, colnames(As12), 
    gsub(&quot;s14b_(\\d)_4$&quot;, &quot;value.\\1&quot;, colnames(As12)))
setnames(As12, colnames(As12), 
    gsub(&quot;s14b_(\\d)_3$&quot;, &quot;ownership.\\1&quot;, colnames(As12)))
setnames(As12, colnames(As12), 
    gsub(&quot;s14b_(\\d)_5$&quot;, &quot;rental.\\1&quot;, colnames(As12)))
summary(As12[duplicated(As12), ])
As12[grepl(8207, hhid), item.2 := .SD[.N, item.1]]
As12[grepl(8207, hhid), own.2 := .SD[.N, own.1]]
As12[grepl(8207, hhid), ownership.2 := .SD[.N, ownership.1]]
As12[grepl(8207, hhid), value.2 := .SD[.N, value.1]]
As12[grepl(8220, hhid), item.2 := .SD[.N, item.1]]
As12[grepl(8220, hhid), own.2 := .SD[.N, own.1]]
As12[grepl(8220, hhid), ownership.2 := .SD[.N, ownership.1]]
As12[grepl(8220, hhid), value.2 := .SD[.N, value.1]]
As12[grepl(8220, hhid), item.3 := .SD[.N, item.2]]
As12[grepl(8220, hhid), own.3 := .SD[.N, own.2]]
As12[grepl(8220, hhid), ownership.3 := .SD[.N, ownership.2]]
As12[grepl(8220, hhid), value.3 := .SD[.N, value.2]]
As12 &lt;- As12[!duplicated(As12[, hhid]), ]
setnames(As11, colnames(As11), gsub(&quot;\\.(\\w)&quot;, &quot;.1\\1&quot;, colnames(As11)))
setnames(As12, colnames(As12), gsub(&quot;\\.(\\w)&quot;, &quot;.2\\1&quot;, colnames(As12)))
As11 &lt;- reshape(As11, direction = &quot;long&quot;, idvar = &quot;hhid&quot;,
    varying = grepout(&quot;\\.\\d&quot;, colnames(As11)))
As12 &lt;- reshape(As12, direction = &quot;long&quot;, idvar = &quot;hhid&quot;,
    varying = grepout(&quot;\\.\\d&quot;, colnames(As12)))
As1 &lt;- rbind(As11, As12, fill = T)
As1[, time := NULL]
As1 &lt;- As1[!(is.na(item) | item == &quot;&quot;), ]
As1[, assetNumber := 1:.N, by = hhid]
setkey(As1, hhid, assetNumber)
As1[, totalSum := sum(value, na.rm = T), by = hhid]
@
Rd 2.
&lt;&lt;&gt;&gt;=
As21 &lt;- As02[[1]]
setnames(As21, colnames(As21), 
    gsub(&quot;sec21_item.*$&quot;, &quot;item.1&quot;, colnames(As21)))
setnames(As21, colnames(As21), 
    gsub(&quot;sec21_oth.*$&quot;, &quot;specify.1&quot;, colnames(As21)))
setnames(As21, colnames(As21), 
    gsub(&quot;cu.*$&quot;, &quot;currentStatus.1&quot;, colnames(As21)))
setnames(As21, colnames(As21), 
    gsub(&quot;dec.*$&quot;, &quot;amount.1&quot;, colnames(As21)))
setnames(As21, colnames(As21), 
    gsub(&quot;^ta.*$&quot;, &quot;value.1&quot;, colnames(As21)))
setnames(As21, colnames(As21), 
    gsub(&quot;^pu.*$&quot;, &quot;lastYear.1&quot;, colnames(As21)))
summary(As21[duplicated(As21), ])
As22 = As02[[2]]
setnames(As22, colnames(As22), 
    gsub(&quot;sec22_co.*$&quot;, &quot;item.2&quot;, colnames(As22)))
setnames(As22, colnames(As22), 
    gsub(&quot;sec22_oth.*$&quot;, &quot;specify.2&quot;, colnames(As22)))
setnames(As22, colnames(As22), 
    gsub(&quot;^cu.*$&quot;, &quot;currentStatus.2&quot;, colnames(As22)))
setnames(As22, colnames(As22), 
    gsub(&quot;^how.*$&quot;, &quot;amount.2&quot;, colnames(As22)))
setnames(As22, colnames(As22), 
    gsub(&quot;.*po.*$&quot;, &quot;ownership.2&quot;, colnames(As22)))
setnames(As22, colnames(As22), 
    gsub(&quot;.*taka.*$&quot;, &quot;value.2&quot;, colnames(As22)))
setnames(As22, colnames(As22), 
    gsub(&quot;.*rented.*$&quot;, &quot;rental.2&quot;, colnames(As22)))
summary(As22[duplicated(As22), ])
As21 &lt;- reshape(As21, direction = &quot;long&quot;, idvar = &quot;hhid&quot;,
    varying = grepout(&quot;\\.\\d&quot;, colnames(As21)))
As22 &lt;- reshape(As22, direction = &quot;long&quot;, idvar = &quot;hhid&quot;,
    varying = grepout(&quot;\\.\\d&quot;, colnames(As22)))
As2 &lt;- rbind(As21, As22, fill = T)
As2[, time := NULL]
As2 &lt;- As2[!(is.na(item) | item == &quot;&quot;), ]
As2[, assetNumber := 1:.N, by = hhid]
setkey(As2, hhid, assetNumber)
As2[, totalSum := sum(value, na.rm = T), by = hhid]
@
Rd 3.
&lt;&lt;&gt;&gt;=
lapply(As03, colnames)
invisible(lapply(As03, function(x) setnames(x, grepout(&quot;code&quot;, colnames(x)), &quot;item&quot;)))
invisible(lapply(As03, function(x) setnames(x, grepout(&quot;spec&quot;, colnames(x)), &quot;specify&quot;)))
invisible(lapply(As03, function(x) setnames(x, grepout(&quot;curr&quot;, colnames(x)), &quot;currentStatus&quot;)))
invisible(lapply(As03, function(x) setnames(x, grepout(&quot;taka&quot;, colnames(x)), &quot;value&quot;)))
invisible(lapply(As03, function(x) setnames(x, grepout(&quot;deci|many&quot;, colnames(x)), &quot;amount&quot;)))
setnames(As03[[1]], &quot;purchased_in_last_one_year&quot;, &quot;lastYear&quot;)
setnames(As03[[2]], c(&quot;sec22_portion_owned&quot;, &quot;sec22_rented_amount_in_tk&quot;), 
    c(&quot;ownership&quot;, &quot;rental&quot;))
As3 &lt;- rbindlist(As[5:6], fill = T)
As3 &lt;- As3[!(is.na(item) | item == &quot;&quot;), ]
As3[, assetNumber := 1:.N, by = hhid]
setkey(As3, hhid, assetNumber)
As3[, totalSum := sum(value, na.rm = T), by = hhid]
@
Bind all 3 rds together.
&lt;&lt;&gt;&gt;=
Aslist &lt;- list(cbind(rd = 1, As1), cbind(rd = 2, As2), cbind(rd = 3, As3))
(As &lt;- rbindlist(Aslist, fill = T))
setwd(pathsave)
write.tablev(As, &quot;asset_holding_rd_1-3.prn&quot;)
@
&lt;&lt;&gt;&gt;=
Asset &lt;- copy(As[!(rd &gt; 1 &amp; grepl(&quot;n&quot;, lastYear)), ])
Asset[, assetNumber := 1:.N, by = c(&quot;hhid&quot;, &quot;rd&quot;)]
Asset[, numberOfAssets := .N, by = c(&quot;hhid&quot;, &quot;rd&quot;)]
Asset[, totalSum := sum(value, na.rm = T), by = c(&quot;hhid&quot;, &quot;rd&quot;)]
as0 &lt;- unique(Asset[, .(hhid, rd, totalSum)])
setkey(as0, hhid, rd)
as0[, rd := rd + 1]
as0 &lt;- as0[rd &lt; 4, ]
as1 &lt;- copy(as0)
as1[, rd := rd + 1]
as1 &lt;- as1[rd &lt; 4, ]
setnames(as0, &quot;totalSum&quot;, &quot;prevSum.1&quot;)
setnames(as1, &quot;totalSum&quot;, &quot;prevSum.2&quot;)
as0[, prevassetNPV.1 := prevSum.1 * .95]
as1[, prevassetNPV.2 := prevSum.2 * .95^(2)]
setkey(as0, hhid, rd); setkey(as1, hhid, rd)
as01 &lt;- as1[as0]
as01[is.na(prevassetNPV.2), prevassetNPV.2 := 0]
as01[, prevassetNPV := prevassetNPV.1 + prevassetNPV.2]
setkey(as01, hhid, rd); setkey(Asset, hhid, rd)
Asset01 &lt;- merge(Asset, as01, by = c(&quot;hhid&quot;, &quot;rd&quot;), all = T)
Asset01[is.na(prevassetNPV), prevassetNPV := 0]
Asset01[, assetNPV := totalSum + prevassetNPV]
# merge with treatment info
setkey(Asset01, hhid, rd); setkey(tr0l, hhid, rd)
Asset01t &lt;- tr0l[Asset01]
@
Drop rd 2 and 3 assets that were not bought in the \textsf{lastYear} to avoid double counting.
&lt;&lt;echo = F, warning = F, results = &#39;markup&#39;, fig.align=&#39;center&#39;, fig.height = 2, fig.width = 3, fig.cap = &quot;Assets by eventual treatmemt status&quot;, fig.lp = &#39;Figure&#39;&gt;&gt;=
asset &lt;- Asset01t[assetNumber == 1, ]
asset.ss &lt;- subset(asset, assetNPV &gt; 0 &amp; !is.na(receivedCredit))
asset.cross &lt;- tapply(asset.ss$assetNPV, 
    list(rd = asset.ss$rd, receivedCredit=asset.ss$receivedCredit), median)
asset.cross2 &lt;- tapply(asset.ss$assetNPV, 
    list(rd = asset.ss$rd, receivedCredit=asset.ss$receivedCredit), mean)
vline.dat &lt;- data.frame(rd = rep(1:3, 2), receivedCredit = repseq(c(F, T), 3))
vline.dat &lt;- cbind(vline.dat, median = c(asset.cross), mean = c(asset.cross2))
library(ggplot2)
ggplot(data = subset(asset, assetNPV &gt; 0 &amp; !is.na(receivedCredit)), 
    aes(x = assetNPV, fill = arm)) +
    geom_histogram(bins = 20) + 
    scale_x_continuous(limits = c(0, 15000)) +
    #scale_y_continuous(limits = c(0, 1000)) +
    geom_vline(aes(xintercept = median), 
        colour=&quot;#990000&quot;, linetype=&quot;dashed&quot;, size = .2, data=vline.dat) +
    geom_vline(aes(xintercept = mean), 
        colour=&quot;#000099&quot;, linetype=&quot;dashed&quot;, size = .2, data=vline.dat) +
    ylab(&quot;Frequency&quot;) + xlab(&quot;Asset NPV (Tk)&quot;) + labs(fill = &quot;arm&quot;) +
    facet_grid(receivedCredit ~ rd, scales = &quot;free_y&quot;) + 
    theme(axis.title.y = element_text(size = rel(.25), angle = 90), 
        axis.title.x = element_text(size = rel(.25), angle = 0),
        axis.text.x = element_text(size = rel(.5), angle = 30, hjust = 1),
        axis.text.y = element_text(size = rel(.5), angle = 0),
        legend.text = element_text(size=rel(.25)), 
        legend.position = &quot;bottom&quot;, 
        legend.title = element_text(size = rel(.25)),
        legend.key = element_rect(size = rel(.25)),
        legend.key.size = unit(.15, &quot;cm&quot;),
        strip.text = element_text(size=rel(.5)),
        strip.text.x = element_text(margin = margin(.05, 0, .05, 0, &quot;cm&quot;)))
@
The histogram is created by imputing the NPV of household assets by assuming an annual 5\% depreciation rate. We see that, at rd 1, there is no difference in mean of asset holding, while the medians are different. Interestingly, the median difference is preserved in the later rounds. In the meantime, means are not different in rd 1 yet they come to differ in later rounds. The subjects who actually received credits have higher mean asset holding. Given that the median diffrences are unchanged, this indicates that the upper half of the treated asset holders are getting better than the control.

To align dates of receiving credits for the subjects who did not, we use the median \textsf{daysFromStart}. 
&lt;&lt;&gt;&gt;=
setkey(Asset01t, gid, hhid)
# surround with as.double becuse median function returns various types ....
# see SO: https://stackoverflow.com/questions/12125364/why-does-median-trip-up-data-table-integer-versus-double
Asset01t[, medianElapsedDaysOfGroup := 
    as.double(median(elapsed, na.rm = T)), by = gid]
Asset01t[, meanElapsedDaysOfGroup := mean(elapsed, na.rm = T), by = gid]
Asset01t[, elaspsedGroupMedian := &quot;early&quot;]
Asset01t[medianElapsedDaysOfGroup - 
    median(medianElapsedDaysOfGroup, na.rm = T) &lt;= 0, 
    elaspsedGroupMedian := &quot;late&quot;]
Asset01t[, elaspsedGroupMean := &quot;early&quot;]
Asset01t[meanElapsedDaysOfGroup - 
    mean(meanElapsedDaysOfGroup, na.rm = T) &lt;= 0, 
    elaspsedGroupMean := &quot;late&quot;]
Asset01t[, elaspsedGroupMedian := factor(elaspsedGroupMedian)]
Asset01t[, elaspsedGroupMean := factor(elaspsedGroupMean)]
@
&lt;&lt;echo = F, warning = F, results = &#39;markup&#39;, fig.align=&#39;center&#39;, fig.height = 2, fig.width = 3, fig.cap = &quot;Assets by disbursement status&quot;, fig.lp = &#39;Figure&#39;&gt;&gt;=
asset &lt;- Asset01t[assetNumber == 1, ]
asset.ss &lt;- subset(asset, assetNPV &gt; 0 &amp; !is.na(gid) &amp; !is.na(disbursed))
asset.cross &lt;- tapply(asset.ss$assetNPV, 
    list(rd = asset.ss$rd, disbursed=asset.ss$disbursed), median)
asset.cross2 &lt;- tapply(asset.ss$assetNPV, 
    list(rd = asset.ss$rd, disbursed=asset.ss$disbursed), mean)
vline.dat &lt;- data.frame(rd = rep(1:3, 2), disbursed = repseq(c(F, T), 3))
vline.dat &lt;- cbind(vline.dat, median = c(asset.cross), mean = c(asset.cross2))
library(ggplot2)
ggplot(data = asset.ss, 
    aes(x = assetNPV, fill = arm)) +
    geom_histogram(bins = 20) + 
    scale_x_continuous(limits = c(0, 15000)) +
    geom_vline(aes(xintercept = median), 
        colour=&quot;#990000&quot;, linetype=&quot;dashed&quot;, size = .2, data=vline.dat) +
    geom_vline(aes(xintercept = mean), 
        colour=&quot;#000099&quot;, linetype=&quot;dashed&quot;, size = .2, data=vline.dat) +
    ylab(&quot;Frequency&quot;) + xlab(&quot;Asset NPV (Tk)&quot;) + labs(fill = &quot;arm&quot;) +
    facet_grid(disbursed ~ rd, scales = &quot;free_y&quot;) + 
    theme(axis.title.y = element_text(size = rel(.25), angle = 90), 
        axis.title.x = element_text(size = rel(.25), angle = 0),
        axis.text.x = element_text(size = rel(.5), angle = 30, hjust = 1),
        axis.text.y = element_text(size = rel(.5), angle = 0),
        legend.text = element_text(size=rel(.25)), 
        legend.position = &quot;bottom&quot;, 
        legend.title = element_text(size = rel(.25)),
        legend.key = element_rect(size = rel(.25)),
        legend.key.size = unit(.15, &quot;cm&quot;),
        strip.text = element_text(size=rel(.5)),
        strip.text.x = element_text(margin = margin(.05, 0, .05, 0, &quot;cm&quot;)),
        strip.text.y = element_text(margin = margin(.05, 0, .05, 0, &quot;cm&quot;)))
@
In this figure, we dropped observations without \textsf{gid} and \textsf{disbursed}. When \textsf{intDate} is NA (not interviewed), we cannot define disbursement for that round. We know disbursement took place before rd 3, so all \textsf{assignment} = treated have \textsf{disbursed} = T in rd 3.

&lt;&lt;echo = F, warning = F, results = &#39;markup&#39;, fig.align=&#39;center&#39;, fig.height = 2, fig.width = 3, fig.cap = &quot;Assets by elapsed days from disbursement, ATT&quot;, fig.lp = &#39;Figure&#39;&gt;&gt;=
asset &lt;- Asset01t[assetNumber == 1, ]
asset.ss &lt;- subset(asset, assetNPV &gt; 0 &amp; !is.na(gid) &amp; !is.na(elapsed) &amp; receivedCredit)
asset.cross &lt;- tapply(asset.ss$assetNPV, 
    list(rd = asset.ss$rd, elaspsedGroupMedian = asset.ss$elaspsedGroupMedian), median)
asset.cross2 &lt;- tapply(asset.ss$assetNPV, 
    list(rd = asset.ss$rd, elaspsedGroupMedian = asset.ss$elaspsedGroupMedian), mean)
vline.dat &lt;- data.frame(rd = rep(1:3, 2), elaspsedGroupMedian = repseq(c(&quot;early&quot;, &quot;late&quot;), 3))
vline.dat &lt;- cbind(vline.dat, median = c(asset.cross), mean = c(asset.cross2))
library(ggplot2)
ggplot(data = asset.ss, 
    aes(x = assetNPV, fill = arm)) +
    geom_histogram(bins = 20) + 
    scale_x_continuous(limits = c(0, 15000)) +
    geom_vline(aes(xintercept = median), 
        colour=&quot;#990000&quot;, linetype=&quot;dashed&quot;, size = .2, data=vline.dat) +
    geom_vline(aes(xintercept = mean), 
        colour=&quot;#000099&quot;, linetype=&quot;dashed&quot;, size = .2, data=vline.dat) +
    ylab(&quot;Frequency&quot;) + xlab(&quot;Asset NPV (Tk)&quot;) + labs(fill = &quot;arm&quot;) +
    facet_grid(elaspsedGroupMedian ~ rd, scales = &quot;free_y&quot;) + 
    theme(axis.title.y = element_text(size = rel(.25), angle = 90), 
        axis.title.x = element_text(size = rel(.25), angle = 0),
        axis.text.x = element_text(size = rel(.5), angle = 30, hjust = 1),
        axis.text.y = element_text(size = rel(.5), angle = 0),
        legend.text = element_text(size=rel(.25)), 
        legend.position = &quot;bottom&quot;, 
        legend.title = element_text(size = rel(.25)),
        legend.key = element_rect(size = rel(.25)),
        legend.key.size = unit(.15, &quot;cm&quot;),
        strip.text = element_text(size=rel(.5)),
        strip.text.x = element_text(margin = margin(.05, 0, .05, 0, &quot;cm&quot;)),
        strip.text.y = element_text(margin = margin(.05, 0, .05, 0, &quot;cm&quot;)))
@

&lt;&lt;echo = F, warning = F, results = &#39;markup&#39;, fig.align=&#39;center&#39;, fig.height = 3, fig.width = 3, fig.cap = &quot;Assets by elapsed days from disbursement, ATT scatter plot&quot;, fig.lp = &#39;Figure&#39;&gt;&gt;=
asset &lt;- Asset01t[assetNumber == 1, ]
asset.ss &lt;- subset(asset, assetNPV &gt; 0 &amp; !is.na(gid) &amp; !is.na(elapsed) &amp; receivedCredit)
library(ggplot2)
ggplot(data = asset.ss, aes(x = elapsed, y = assetNPV)) +
    #geom_jitter(aes(colour = arm, shape = arm), size = .05, width = .1) + 
    geom_point(aes(colour = arm, shape = arm), size = .05) + 
    scale_shape(solid = F) +
    #scale_y_continuous(limits = c(0, 25000)) + 
    scale_y_log10() +
    xlab(&quot;elapsed day grouping&quot;) + ylab(&quot;Asset NPV (Tk)&quot;) + labs(fill = &quot;arm&quot;) +
    facet_grid(arm ~ rd) + 
#   stat_smooth(method = &quot;loess&quot;, size = .2, n = 150) +
    geom_smooth(method = &quot;loess&quot;, size = .2) +
    theme(axis.title.y = element_text(size = rel(.25), angle = 90), 
        axis.title.x = element_text(size = rel(.25), angle = 0),
        axis.text.x = element_text(size = rel(.5), angle = 30, hjust = 1),
        axis.text.y = element_text(size = rel(.5), angle = 0),
        legend.text = element_text(size=rel(.25)), 
        legend.position = &quot;bottom&quot;, 
        legend.title = element_text(size = rel(.25)),
        legend.key = element_rect(size = rel(.25)),
        legend.key.size = unit(.15, &quot;cm&quot;),
        strip.text = element_text(size=rel(.5)),
        strip.text.x = element_text(margin = margin(.05, 0, .05, 0, &quot;cm&quot;)),
        strip.text.y = element_text(margin = margin(.05, 0, .05, 0, &quot;cm&quot;)))
@
In this scatter and loess plots, we put asset values against the treatment exposure, facetted by treatment arms. This aims to mimic ATT under a continuous treatment. The treatment exposure is defined by the elapsed days since receiving a credit. Since the treatment exposure is randomised, this is a statisically valid procedure to observe the treatment response without major comfounding.

This plotting exercise leads one to consider the statisical model underlying the graphs. For an individual $i$&#39;s outcome $y_{i}$, the treatment assignment $D_{i}=0,1$ may have an impact on the outcome. The standard Rubin causal model deals with a binary indicator variable for $D_{i}$. In our design, we vary the dates of intervention among the subjects. So what we randomly vary is the duration under treatment, or dose exposure, denoted with $D_{i}(t)$ where $t$ is the calendar date of intervention. On average, there is about 1 year difference in $t$ within a cluster of 20 subjects. Given that we randomise the calendar dates of starting the intevention, we can assume actual duration $t\in[t_{0}, t_{1}]$ is orthogonal to potential treatment response $y(t)$ for all $t$. Under the simplest setting, we follow \citet{Imbens2000, HiranoImbens2004, ImaiVanDyk2004, Egger2013} assume the following conditional orthogonality in the continuous case. Denoting $T$ as a random variable with its realisation written as $t$, we assume:
\[
y(t)\perp T|\bfx.
\]
\citet{HiranoImbens2004} shows that this is equivalent to
\[
\bfx\perp 1\{T=t\}|g(t,\bfx)
\]
where $g(t,\bfx)$ is a generalised propesity score that gives the density of treatment at $t$ given $\bfx$. This shows that one can estimate continuous treatment effect by first, estimating GPS $g$, second, estimate the conditional expectation of outcome as a function of $g$ and $\bfx$:
\[
\beta(t, g)=\E[y|T=t, G=g(t,\bfx)],
\]
and then average over $g$ for a given $t$ to obtain the dose-response function
\[
\beta(t)=\E[\beta(t, g)|\bfx].
\]
The approach is preceded by applied works related job training duration \citep{Kluveetal2012}. 

We compare the effects of treatment exposure differences within the same group.
&lt;&lt;echo = F, warning = F, results = &#39;markup&#39;, fig.align=&#39;center&#39;, fig.height = 3, fig.width = 3, fig.cap = &quot;Assets by elapsed days from disbursement, within a group&quot;, fig.lp = &#39;Figure&#39;&gt;&gt;=
asset &lt;- Asset01t[assetNumber == 1, ]
asset.ss &lt;- subset(asset, assetNPV &gt; 0 &amp; !is.na(gid) &amp; !is.na(elapsed))
asset.ss[grepl(&quot;tr&quot;, assignment), 
    avgElapsed1 := mean(elapsed, na.rm = T), by = c(&quot;rd&quot;, &quot;gid&quot;)]
asset.ss[grepl(&quot;tr&quot;, assignment), 
    avgNPV1 := mean(assetNPV, na.rm = T), by = c(&quot;rd&quot;, &quot;gid&quot;)]
asset.ss[grepl(&quot;co&quot;, assignment), 
    avgElapsed0 := mean(elapsed, na.rm = T), by = c(&quot;rd&quot;, &quot;gid&quot;)]
asset.ss[grepl(&quot;co&quot;, assignment), 
    avgNPV0 := mean(assetNPV, na.rm = T), by = c(&quot;rd&quot;, &quot;gid&quot;)]
asset.ss[, avgDiffElapsed := avgElapsed1 - avgElapsed0]
asset.ss[, avgDiffNPV := avgNPV1 - avgNPV0]
library(ggplot2)
ggplot(data = asset.ss, aes(x = avgDiffElapsed, y = avgDiffNPV)) +
    geom_point(aes(colour = arm, shape = arm), size = .05) + 
    scale_shape(solid = F) +
    xlab(&quot;difference in elapsed days&quot;) + ylab(&quot;difference in mean asset NPV (Tk)&quot;) + 
    labs(fill = &quot;arm&quot;) + facet_grid(arm ~ rd, scale = &quot;free_y&quot;) + 
#   stat_smooth(method = &quot;loess&quot;, size = .2, n = 150) +
    geom_smooth(method = &quot;loess&quot;, size = .2) +
    geom_hline(aes(yintercept = 0), colour=&quot;#990000&quot;, linetype=&quot;dashed&quot;, size = .2) +
    theme(axis.title.y = element_text(size = rel(.25), angle = 90), 
        axis.title.x = element_text(size = rel(.25), angle = 0),
        axis.text.x = element_text(size = rel(.5), angle = 30, hjust = 1),
        axis.text.y = element_text(size = rel(.5), angle = 0),
        legend.text = element_text(size=rel(.25)), 
        legend.position = &quot;bottom&quot;, 
        legend.title = element_text(size = rel(.25)),
        legend.key = element_rect(size = rel(.25)),
        legend.key.size = unit(.15, &quot;cm&quot;),
        strip.text = element_text(size=rel(.5)),
        strip.text.x = element_text(margin = margin(.05, 0, .05, 0, &quot;cm&quot;)),
        strip.text.y = element_text(margin = margin(.05, 0, .05, 0, &quot;cm&quot;)))
@


\section{livestock}

&lt;&lt;&gt;&gt;=
(fn.lvstk &lt;- grepout(&quot;d/s08|2/s.*9_|3/s.*_8&quot;, fn))
setwd(pathsource.mar)
Ls = copy(X[fn %in% fn.lvstk])
Ls &lt;- lapply(Ls, function(x) if (any(grepl(&quot;^id$&quot;, colnames(x)))) 
    setnames(x, &quot;id&quot;, &quot;hhid&quot;) else x)
Ls &lt;- lapply(Ls, function(x) 
    x[!apply(is.na(x[, -grep(&quot;hh|mid|u_id&quot;, colnames(x)), with = F]) |
        x[, -grep(&quot;hh|mid|u_id&quot;, colnames(x)), with = F] == &quot;&quot;, 1, all), ])
@


\section{livestock}

&lt;&lt;echo = F, warning = F&gt;&gt;=
setwd(pathsource.mar)
foldername &lt;- list.dirs(path = &quot;.&quot;, recursive = T, full.names = T)
foldername &lt;- foldername[!grepl(&quot;add|ori|^\\.$|1$&quot;, foldername)]
fn &lt;- unique(list.files(path = foldername, pattern = &quot;.prn$&quot;, 
    recursive = T, full.names = T))
X = lapply(fn, fread, integer64 = &quot;double&quot;)
&lt;&lt;&gt;&gt;=
(fn.lvstk &lt;- grepout(&quot;d/s08|2/s.*9_|3/s.*_8&quot;, fn))
setwd(pathsource.mar)
Ls = copy(X[fn %in% fn.lvstk])
Ls &lt;- lapply(Ls, function(x) if (any(grepl(&quot;^id$&quot;, colnames(x)))) 
    setnames(x, &quot;id&quot;, &quot;hhid&quot;) else x)
Ls &lt;- lapply(Ls, function(x) 
    x[!apply(is.na(x[, -grep(&quot;hh|mid|u_id&quot;, colnames(x)), with = F]) |
        x[, -grep(&quot;hh|mid|u_id&quot;, colnames(x)), with = F] == &quot;&quot; |
        x[, -grep(&quot;hh|mid|u_id&quot;, colnames(x)), with = F] == &quot;No&quot;, 1, all), ])
Ls &lt;- lapply(Ls, a2b, a = NA, b = 0)
Ls &lt;- lapply(Ls, a2b, a = &quot;&quot;, b = 0)
Ls[1:2] &lt;- lapply(Ls[1:2], setkey, hhid, mid)
Ls[-(1:2)] &lt;- lapply(Ls[-(1:2)], setkey, hhid)
@
Rd 1.
&lt;&lt;&gt;&gt;=
Ls1 &lt;- merge(Ls[[1]], Ls[[2]], by = c(&quot;hhid&quot;, &quot;mid&quot;), all = T)
Ls2 &lt;- merge(Ls[[3]], Ls[[4]], by = &quot;hhid&quot;, all = T)
Ls2 &lt;- merge(Ls2, Ls[[5]], by = &quot;hhid&quot;, all = T)
Ls3 &lt;- merge(Ls[[6]], Ls[[7]], by = &quot;hhid&quot;, all = T)
Ls3 &lt;- merge(Ls3, Ls[[8]], by = &quot;hhid&quot;, all = T)
# M: managing, L: leased in
Ls1[, ushiM := s8a_a_2 + s8a_a_3]
Ls1[, calfM := s8a_a_4]
Ls1[, yagiM := s8a_a_5 + s8a_a_6]
Ls1[, ushiL := s8a_b_8 + s8a_b_9]
Ls1[, calfL := s8a_b_10]
Ls1[, yagiL := s8a_b_11]
Ls1 &lt;- a2b(Ls1, NA, 0)
destat(Ls1[, .(ushiM, calfM, yagiM, ushiL, calfL)])
cpr &lt;- destat(Ls1[s8a_b_15 &gt; 0, s8a_b_15])
cpr2 &lt;- rbind(c(destat(Ls1[s8a_b_15 &gt; 0, s8a_b_15])),
c(destat(Ls1[s8a_b_16 &gt; 0, s8a_b_16])),
c(destat(Ls1[s8a_b_17 &gt; 0, s8a_b_17])))
dimnames(cpr2) &lt;- list(c(&quot;female calf&quot;, &quot;male calf&quot;, &quot;ox&quot;),
    colnames(cpr))
@
Price: female calf, male calf, ox.
&lt;&lt;&gt;&gt;=
cpr2
@
Let the price to be used as median price, and cow price is 15000. Lease share is 50\%.
&lt;&lt;&gt;&gt;=
destat(Ls1[, s8a_b_7])
destat(Ls1[s8a_b_18 &gt; 0, s8a_b_18])
destat(Ls1[s8a_b_24 &gt; 0, s8a_b_24])
destat(Ls2[grepl(&quot;a&quot;, s17a_code) &amp; s17a_4 &gt; 0, s17a_4])
destat(Ls3[grepl(&quot;cow&quot;, s17a_code) &amp; s17a_4 &gt; 0, s17a_4])
Ls1[, cowValue := ushiM * 15000]
Ls1[, calfValue := calfM * 10000]
Ls1[, cowLValue := ushiL * 15000 * .5]
Ls1[, calfLValue := calfL * 10000 * .5]
@
Goats: Take prices from late rounds. 1900.
&lt;&lt;&gt;&gt;=
destat(Ls2[grepl(&quot;c&quot;, s17a_code) &amp; s17a_4 &gt; 0, s17a_4])
destat(Ls3[grepl(&quot;goa&quot;, s17a_code) &amp; s17a_4 &gt; 0, s17a_4])
Ls1[, yagiValue := yagiM * 1900]
Ls1[, yagiLValue := yagiL * 1900 * .5]
@
Total livestock value.
&lt;&lt;&gt;&gt;=
Ls1[, totalLivestockValue := cowValue + calfValue + yagiValue + 
    cowLValue + calfLValue + yagiLValue]
@
Rd2.
&lt;&lt;&gt;&gt;=
Ls2 &lt;- a2b(Ls2, NA, 0)
Ls2[, livestockValue := s17a_3 * s17a_4]
Ls2[grepl(&quot;sh&quot;, s17a_2), livestockValue := livestockValue * .5]
Ls2[grepl(&quot;0&quot;, s17a_2), livestockValue := 0]
Ls2[, livestockSoldValue := s17a_9]
Ls2[, livestockDCValue := (s17a_6 + s17a_7) * s17a_4]
Ls2[, totalLivestockValue := livestockValue + livestockSoldValue + livestockDCValue]
#Ls2[grepl(&quot;a&quot;, s17a_code) &amp; s17a_8 &gt; 0, .(s17a_8, s17a_9)]
@
Rd3.
&lt;&lt;&gt;&gt;=
Ls3 &lt;- a2b(Ls3, NA, 0)
Ls3[, livestockValue := s17a_3 * s17a_4]
Ls3[grepl(&quot;sh&quot;, s17a_2), livestockValue := livestockValue * .5]
Ls3[grepl(&quot;0&quot;, s17a_2), livestockValue := 0]
Ls3[, livestockSoldValue := s17a_9]
Ls3[, livestockDCValue := (s17a_6 + s17a_7) * s17a_4]
Ls3[, totalLivestockValue := livestockValue + livestockSoldValue + livestockDCValue]
@
Merge.
&lt;&lt;&gt;&gt;=
ls &lt;- rbind(cbind(rd = 1, Ls1[, .(hhid, totalLivestockValue)]),
    cbind(rd = 2, Ls2[, .(hhid, totalLivestockValue)]),
    cbind(rd = 3, Ls3[, .(hhid, totalLivestockValue)]))
setkey(ls, hhid, rd); setkey(tr1l, hhid, rd)
lst &lt;- tr0l[ls]
@
We compare the effects of treatment exposure differences within the same group.
&lt;&lt;echo = T, warning = F, fig.align=&#39;center&#39;, fig.height = 1.5, fig.width = 3, fig.cap = &quot;Assets by elapsed days from disbursement within a group&quot;, fig.lp = &#39;Figure&#39;&gt;&gt;=
asset &lt;- Asset01t[assetNumber == 1, ]
asset.ss &lt;- subset(asset, assetNPV &gt; 0 &amp; !is.na(gid) &amp; !is.na(elapsed))
setkey(asset.ss, rd, gid, asssignment)
asset.ss[, avgElapsed := mean(elapsed, na.rm = T), by = c(&quot;rd&quot;, &quot;gid&quot;, &quot;assignment&quot;)]
asset.ss[, avgElapsed0 := avgElapsed[1], by = c(&quot;rd&quot;, &quot;gid&quot;)]
asset.ss[, avgElapsed1 := avgElapsed[.N], by = c(&quot;rd&quot;, &quot;gid&quot;)]
asset.ss[gid == 70650 &amp; grepl(&quot;co&quot;, assignment), ]
asset.ss[gid == 70204&amp; rd == 1, .(rd, gid, assignment, avgElapsed, avgElapsed0, avgElapsed1) ]
asset.ss[, avgNPV := mean(assetNPV/1000, na.rm = T), 
    by = c(&quot;rd&quot;, &quot;gid&quot;, &quot;assignment&quot;)]
asset.ss[, avgNPV0 := avgNPV[1], by = c(&quot;rd&quot;, &quot;gid&quot;)]
asset.ss[, avgNPV1 := avgNPV[.N], by = c(&quot;rd&quot;, &quot;gid&quot;)]
asset.ss[, avgDiffElapsed := avgElapsed1 - avgElapsed0]
asset.ss[, avgDiffNPV := avgNPV1 - avgNPV0]
setkey(asset.ss, rd, gid, assignment)
dim(asset.sss &lt;- asset.ss[!duplicated(asset.ss[, .(rd, gid, assignment)]), ])
library(ggplot2)
ggplot(data = asset.sss, aes(x = avgDiffElapsed, y = avgDiffNPV)) +
    geom_point(aes(colour = arm, shape = arm), size = .05) + 
    scale_shape(solid = F) +
    xlab(&quot;difference in elapsed days&quot;) + ylab(&quot;difference in mean asset NPV (Tk &#39;000)&quot;) + 
    labs(fill = &quot;arm&quot;) + facet_grid( ~ rd) + 
#   stat_smooth(method = &quot;loess&quot;, size = .2, n = 150) +
    geom_smooth(method = &quot;loess&quot;, size = .2) +
    geom_hline(aes(yintercept = 0), colour=&quot;#990000&quot;, linetype=&quot;dashed&quot;, size = .2) +
    theme(axis.title.y = element_text(size = rel(.25), angle = 90), 
        axis.title.x = element_text(size = rel(.25), angle = 0),
        axis.text.x = element_text(size = rel(.5), angle = 30, hjust = 1),
        axis.text.y = element_text(size = rel(.5), angle = 0),
        legend.text = element_text(size=rel(.25)), 
        legend.position = &quot;bottom&quot;, 
        legend.title = element_text(size = rel(.25)),
        legend.key = element_rect(size = rel(.25)),
        legend.key.size = unit(.15, &quot;cm&quot;),
        strip.text = element_text(size=rel(.5)),
        strip.text.x = element_text(margin = margin(.05, 0, .05, 0, &quot;cm&quot;)),
        strip.text.y = element_text(margin = margin(.05, 0, .05, 0, &quot;cm&quot;)))
@
&lt;&lt;echo = T, warning = F, fig.align=&#39;center&#39;, fig.height = 3, fig.width = 3, fig.cap = &quot;Assets by elapsed days from disbursement, within a group&quot;, fig.lp = &#39;Figure&#39;&gt;&gt;=
library(ggplot2)
ggplot(data = asset.sss, aes(x = avgDiffElapsed, y = avgDiffNPV)) +
    geom_point(aes(colour = arm, shape = arm), size = .05) + 
    scale_shape(solid = F) +
    xlab(&quot;difference in elapsed days&quot;) + ylab(&quot;difference in mean asset NPV (Tk &#39;000)&quot;) + 
    labs(fill = &quot;arm&quot;) + facet_grid(arm ~ rd, scale = &quot;free_y&quot;) + 
#   stat_smooth(method = &quot;loess&quot;, size = .2, n = 150) +
    geom_smooth(method = &quot;loess&quot;, size = .2) +
    geom_hline(aes(yintercept = 0), colour=&quot;#990000&quot;, linetype=&quot;dashed&quot;, size = .2) +
    theme(axis.title.y = element_text(size = rel(.25), angle = 90), 
        axis.title.x = element_text(size = rel(.25), angle = 0),
        axis.text.x = element_text(size = rel(.5), angle = 30, hjust = 1),
        axis.text.y = element_text(size = rel(.5), angle = 0),
        legend.text = element_text(size=rel(.25)), 
        legend.position = &quot;bottom&quot;, 
        legend.title = element_text(size = rel(.25)),
        legend.key = element_rect(size = rel(.25)),
        legend.key.size = unit(.15, &quot;cm&quot;),
        strip.text = element_text(size=rel(.5)),
        strip.text.x = element_text(margin = margin(.05, 0, .05, 0, &quot;cm&quot;)),
        strip.text.y = element_text(margin = margin(.05, 0, .05, 0, &quot;cm&quot;)))
@


\section{livestock}

&lt;&lt;echo = F, warning = F&gt;&gt;=
setwd(pathsource.mar)
foldername &lt;- list.dirs(path = &quot;.&quot;, recursive = T, full.names = T)
foldername &lt;- foldername[!grepl(&quot;add|ori|^\\.$|1$&quot;, foldername)]
fn &lt;- unique(list.files(path = foldername, pattern = &quot;.prn$&quot;, 
    recursive = T, full.names = T))
X = lapply(fn, fread, integer64 = &quot;double&quot;)
&lt;&lt;&gt;&gt;=
(fn.lvstk &lt;- grepout(&quot;d/s08|2/s.*9_|3/s.*_8&quot;, fn))
setwd(pathsource.mar)
Ls = copy(X[fn %in% fn.lvstk])
Ls &lt;- lapply(Ls, function(x) if (any(grepl(&quot;^id$&quot;, colnames(x)))) 
    setnames(x, &quot;id&quot;, &quot;hhid&quot;) else x)
Ls &lt;- lapply(Ls, function(x) 
    x[!apply(is.na(x[, -grep(&quot;hh|mid|u_id&quot;, colnames(x)), with = F]) |
        x[, -grep(&quot;hh|mid|u_id&quot;, colnames(x)), with = F] == &quot;&quot; |
        x[, -grep(&quot;hh|mid|u_id&quot;, colnames(x)), with = F] == &quot;No&quot;, 1, all), ])
Ls &lt;- lapply(Ls, a2b, a = NA, b = 0)
Ls &lt;- lapply(Ls, a2b, a = &quot;&quot;, b = 0)
Ls[1:2] &lt;- lapply(Ls[1:2], setkey, hhid, mid)
Ls[-(1:2)] &lt;- lapply(Ls[-(1:2)], setkey, hhid)
Ls1 &lt;- merge(Ls[[1]], Ls[[2]], by = c(&quot;hhid&quot;, &quot;mid&quot;), all = T)
Ls2 &lt;- merge(Ls[[3]], Ls[[4]], by = &quot;hhid&quot;, all = T)
Ls2 &lt;- merge(Ls2, Ls[[5]], by = &quot;hhid&quot;, all = T)
Ls2 &lt;- Ls2[!duplicated(Ls2[, .(hhid, s17a_code)]), ]
Ls3 &lt;- merge(Ls[[6]], Ls[[7]], by = &quot;hhid&quot;, all = T)
Ls3 &lt;- merge(Ls3, Ls[[8]], by = &quot;hhid&quot;, all = T)
Ls3 &lt;- Ls3[!duplicated(Ls3[, .(hhid, s17a_code)]), ]
@
Rd 1.
&lt;&lt;&gt;&gt;=
# M: managing, L: leased in
Ls1[, ushiM := s8a_a_2 + s8a_a_3]
Ls1[, calfM := s8a_a_4]
Ls1[, yagiM := s8a_a_5 + s8a_a_6]
Ls1[, ushiL := s8a_b_8 + s8a_b_9]
Ls1[, calfL := s8a_b_10]
Ls1[, yagiL := s8a_b_11]
Ls1 &lt;- a2b(Ls1, NA, 0)
destat(Ls1[, .(ushiM, calfM, yagiM, ushiL, calfL)])
cpr &lt;- destat(Ls1[s8a_b_15 &gt; 0, s8a_b_15])
cpr2 &lt;- rbind(c(destat(Ls1[s8a_b_15 &gt; 0, s8a_b_15])),
c(destat(Ls1[s8a_b_16 &gt; 0, s8a_b_16])),
c(destat(Ls1[s8a_b_17 &gt; 0, s8a_b_17])))
dimnames(cpr2) &lt;- list(c(&quot;female calf&quot;, &quot;male calf&quot;, &quot;ox&quot;),
    colnames(cpr))
@
Price: female calf, male calf, ox.
&lt;&lt;&gt;&gt;=
cpr2
@
Let the price to be used as median price, and cow price is 15000. Lease share is 50\%.
&lt;&lt;&gt;&gt;=
destat(Ls1[s8a_b_18 &gt; 0, s8a_b_18])
destat(Ls1[s8a_b_24 &gt; 0, s8a_b_24])
destat(Ls2[grepl(&quot;a&quot;, s17a_code) &amp; s17a_4 &gt; 0, s17a_4])
destat(Ls3[grepl(&quot;cow&quot;, s17a_code) &amp; s17a_4 &gt; 0, s17a_4])
Ls1[, cowValue := ushiM * 15000]
Ls1[, calfValue := calfM * 10000]
Ls1[, cowLValue := ushiL * 15000 * .5]
Ls1[, calfLValue := calfL * 10000 * .5]
@
Goats: Take prices from late rounds. 1900.
&lt;&lt;&gt;&gt;=
destat(Ls2[grepl(&quot;c&quot;, s17a_code) &amp; s17a_4 &gt; 0, s17a_4])
destat(Ls3[grepl(&quot;goa&quot;, s17a_code) &amp; s17a_4 &gt; 0, s17a_4])
Ls1[, yagiValue := yagiM * 1900]
Ls1[, yagiLValue := yagiL * 1900 * .5]
@
Total livestock value.
&lt;&lt;&gt;&gt;=
Ls1[, totalLivestockValue := cowValue + calfValue + yagiValue + 
    cowLValue + calfLValue + yagiLValue]
setkey(Ls1, hhid)
@
Rd2.
&lt;&lt;&gt;&gt;=
Ls2 &lt;- a2b(Ls2, NA, 0)
Ls2[, livestockValue := s17a_3 * s17a_4]
Ls2[grepl(&quot;sh&quot;, s17a_2), livestockValue := livestockValue * .5]
Ls2[grepl(&quot;0&quot;, s17a_2), livestockValue := 0]
Ls2[, livestockValue := sum(livestockValue, na.rm = T), by = hhid]
Ls2[, livestockSoldValue := s17a_9]
Ls2[, livestockSoldValue := sum(livestockSoldValue, na.rm = T), 
    by = hhid]
Ls2[, livestockDCValue := (s17a_6 + s17a_7) * s17a_4]
Ls2[, livestockDCValue := sum(livestockDCValue, na.rm = T), 
    by = hhid]
Ls2[, totalLivestockValue := sum(livestockValue + livestockSoldValue + livestockDCValue), by = hhid]
Ls2 &lt;- Ls2[!duplicated(Ls2[, hhid]), ]
#Ls2[grepl(&quot;a&quot;, s17a_code) &amp; s17a_8 &gt; 0, .(s17a_8, s17a_9)]
@
Rd3.
&lt;&lt;&gt;&gt;=
Ls3 &lt;- a2b(Ls3, NA, 0)
Ls3[, livestockValue := s17a_3 * s17a_4]
Ls3[grepl(&quot;sh&quot;, s17a_2), livestockValue := livestockValue * .5]
Ls3[grepl(&quot;0&quot;, s17a_2), livestockValue := 0]
Ls3[, livestockValue := sum(livestockValue, na.rm = T), by = hhid]
Ls3[, livestockSoldValue := s17a_9]
Ls3[, livestockSoldValue := sum(livestockSoldValue, na.rm = T), 
    by = hhid]
Ls3[, livestockDCValue := (s17a_6 + s17a_7) * s17a_4]
Ls3[, livestockDCValue := sum(livestockDCValue, na.rm = T), 
    by = hhid]
Ls3[, totalLivestockValue := sum(livestockValue + livestockSoldValue + livestockDCValue), by = hhid]
Ls3 &lt;- Ls3[!duplicated(Ls3[, hhid]), ]
@
Merge.
&lt;&lt;&gt;&gt;=
ls &lt;- rbind(cbind(rd = 1, Ls1[, .(hhid, totalLivestockValue)]),
    cbind(rd = 2, Ls2[, .(hhid, totalLivestockValue)]),
    cbind(rd = 3, Ls3[, .(hhid, totalLivestockValue)]))
ls &lt;- ls[!duplicated(ls), ]
ls[, totalLivestockValue := totalLivestockValue/1000]
setkey(ls, hhid, rd); setkey(tr1l, hhid, rd)
lst &lt;- tr0l[ls]
&lt;&lt;&gt;&gt;=
lstk.ss &lt;- subset(lst, !is.na(gid) &amp; !is.na(elapsed))
setkey(lstk.ss, rd, gid, assignment)
lstk.ss[, avgElapsed := mean(elapsed, na.rm = T), by = c(&quot;rd&quot;, &quot;gid&quot;, &quot;assignment&quot;)]
lstk.ss[, avgElapsed0 := avgElapsed[1], by = c(&quot;rd&quot;, &quot;gid&quot;)]
lstk.ss[, avgElapsed1 := avgElapsed[.N], by = c(&quot;rd&quot;, &quot;gid&quot;)]
lstk.ss[, avgLstkValue := mean(totalLivestockValue, na.rm = T), 
    by = c(&quot;rd&quot;, &quot;gid&quot;, &quot;assignment&quot;)]
lstk.ss[, avgLstkValue0 := avgLstkValue[1], by = c(&quot;rd&quot;, &quot;gid&quot;)]
lstk.ss[, avgLstkValue1 := avgLstkValue[.N], by = c(&quot;rd&quot;, &quot;gid&quot;)]
lstk.ss[gid == 70204&amp; rd == 1, .(rd, gid, assignment, avgElapsed, 
    avgElapsed0, avgElapsed1, avgLstkValue, avgLstkValue0, avgLstkValue1) ]
lstk.ss[, avgDiffElapsed := avgElapsed1 - avgElapsed0]
lstk.ss[, avgDiffLstkValue := avgLstkValue1 - avgLstkValue0]
setkey(lstk.ss, rd, gid, assignment)
dim(lstk.sss &lt;- lstk.ss[!duplicated(lstk.ss[, .(rd, gid, assignment)]), ])
@
We compare the effects of treatment exposure differences within the same group.
&lt;&lt;echo = T, warning = F, fig.align=&#39;center&#39;, fig.height = 1.5, fig.width = 3, fig.cap = &quot;Livestock by elapsed days from disbursement within a group&quot;, fig.lp = &#39;Figure&#39;&gt;&gt;=
library(ggplot2)
ggplot(data = lstk.sss, aes(x = avgDiffElapsed, y = avgDiffLstkValue)) +
    geom_point(aes(colour = arm, shape = arm), size = .05) + 
    scale_shape(solid = F) + scale_y_continuous() + 
    xlab(&quot;difference in elapsed days&quot;) + ylab(&quot;difference in mean livestock value (Tk &#39;000)&quot;) + 
    labs(fill = &quot;arm&quot;) + facet_grid( ~ rd) + 
#   stat_smooth(method = &quot;loess&quot;, size = .2, n = 150) +
    geom_smooth(method = &quot;loess&quot;, size = .2) +
    geom_hline(aes(yintercept = 0), colour=&quot;#990000&quot;, linetype=&quot;dashed&quot;, size = .2) +
    theme(axis.title.y = element_text(size = rel(.25), angle = 90), 
        axis.title.x = element_text(size = rel(.25), angle = 0),
        axis.text.x = element_text(size = rel(.5), angle = 30, hjust = 1),
        axis.text.y = element_text(size = rel(.5), angle = 0),
        legend.text = element_text(size=rel(.25)), 
        legend.position = &quot;bottom&quot;, 
        legend.title = element_text(size = rel(.25)),
        legend.key = element_rect(size = rel(.25)),
        legend.key.size = unit(.15, &quot;cm&quot;),
        strip.text = element_text(size=rel(.5)),
        strip.text.x = element_text(margin = margin(.05, 0, .05, 0, &quot;cm&quot;)),
        strip.text.y = element_text(margin = margin(.05, 0, .05, 0, &quot;cm&quot;)))
@
&lt;&lt;echo = T, warning = F, fig.align=&#39;center&#39;, fig.height = 3, fig.width = 3, fig.cap = &quot;Livestock by elapsed days from disbursement, within a group&quot;, fig.lp = &#39;Figure&#39;&gt;&gt;=
library(ggplot2)
ggplot(data = lstk.sss, aes(x = avgDiffElapsed, y = avgDiffLstkValue)) +
    geom_point(aes(colour = arm, shape = arm), size = .05) + 
    scale_shape(solid = F) + 
    xlab(&quot;difference in elapsed days&quot;) + ylab(&quot;difference in mean livestock value (Tk &#39;000)&quot;) + 
    labs(fill = &quot;arm&quot;) + facet_grid(arm ~ rd) + 
#   stat_smooth(method = &quot;loess&quot;, size = .2, n = 150) +
    geom_smooth(method = &quot;loess&quot;, size = .2) +
    geom_hline(aes(yintercept = 0), colour=&quot;#990000&quot;, linetype=&quot;dashed&quot;, size = .2) +
    theme(axis.title.y = element_text(size = rel(.25), angle = 90), 
        axis.title.x = element_text(size = rel(.25), angle = 0),
        axis.text.x = element_text(size = rel(.5), angle = 30, hjust = 1),
        axis.text.y = element_text(size = rel(.5), angle = 0),
        legend.text = element_text(size=rel(.25)), 
        legend.position = &quot;bottom&quot;, 
        legend.title = element_text(size = rel(.25)),
        legend.key = element_rect(size = rel(.25)),
        legend.key.size = unit(.15, &quot;cm&quot;),
        strip.text = element_text(size=rel(.5)),
        strip.text.x = element_text(margin = margin(.05, 0, .05, 0, &quot;cm&quot;)),
        strip.text.y = element_text(margin = margin(.05, 0, .05, 0, &quot;cm&quot;)))
@
Add assets and livestock.
&lt;&lt;&gt;&gt;=
al.ss &lt;- merge(asset.ss, lstk.ss, 
    by = c(&quot;rd&quot;, &quot;gid&quot;, &quot;hhid&quot;, &quot;assignment&quot;, &quot;arm&quot;, &quot;elapsed&quot;), all = T)
al.ss[is.na(assetNPV), assetNPV := 0]
al.ss[is.na(totalLivestockValue), totalLivestockValue := 0]
al.ss[, val := (assetNPV/1000 + totalLivestockValue)]
setkey(al.ss, rd, gid, assignment)
al.ss[, avgElapsed := mean(elapsed, na.rm = T), by = c(&quot;rd&quot;, &quot;gid&quot;, &quot;assignment&quot;)]
al.ss[, avgElapsed0 := avgElapsed[1], by = c(&quot;rd&quot;, &quot;gid&quot;)]
al.ss[, avgElapsed1 := avgElapsed[.N], by = c(&quot;rd&quot;, &quot;gid&quot;)]
al.ss[, avgVal := mean(val, na.rm = T), by = c(&quot;rd&quot;, &quot;gid&quot;, &quot;assignment&quot;)]
al.ss[, avgVal0 := avgVal[1], by = c(&quot;rd&quot;, &quot;gid&quot;)]
al.ss[, avgVal1 := avgVal[.N], by = c(&quot;rd&quot;, &quot;gid&quot;)]
unique(al.ss[gid == 70101 &amp; rd == 1, .(avgElapsed0, avgElapsed1)])
al.ss[, avgDiffElapsed := avgElapsed1 - avgElapsed0]
al.ss[, avgDiffVal := avgVal1 - avgVal0]
dim(al.sss &lt;- al.ss[!duplicated(al.ss[, .(rd, gid, assignment)]), ])
&lt;&lt;echo = T, warning = F, fig.align=&#39;center&#39;, fig.height = 1.5, fig.width = 3, fig.cap = &quot;Total assets by elapsed days from disbursement within a group&quot;, fig.lp = &#39;Figure&#39;&gt;&gt;=
library(ggplot2)
ggplot(data = al.sss, aes(x = avgDiffElapsed, y = avgDiffVal)) +
    geom_point(aes(colour = arm, shape = arm), size = .05) + 
    scale_shape(solid = F) + 
    xlab(&quot;difference in elapsed days&quot;) + ylab(&quot;difference in mean value (Tk &#39;000)&quot;) + 
    labs(fill = &quot;arm&quot;) + facet_grid(. ~ rd) + 
#   stat_smooth(method = &quot;loess&quot;, size = .2, n = 150) +
    geom_smooth(method = &quot;loess&quot;, size = .2) +
    geom_hline(aes(yintercept = 0), colour=&quot;#990000&quot;, linetype=&quot;dashed&quot;, size = .2) +
    theme(axis.title.y = element_text(size = rel(.25), angle = 90), 
        axis.title.x = element_text(size = rel(.25), angle = 0),
        axis.text.x = element_text(size = rel(.5), angle = 30, hjust = 1),
        axis.text.y = element_text(size = rel(.5), angle = 0),
        legend.text = element_text(size=rel(.25)), 
        legend.position = &quot;bottom&quot;, 
        legend.title = element_text(size = rel(.25)),
        legend.key = element_rect(size = rel(.25)),
        legend.key.size = unit(.15, &quot;cm&quot;),
        strip.text = element_text(size=rel(.5)),
        strip.text.x = element_text(margin = margin(.05, 0, .05, 0, &quot;cm&quot;)),
        strip.text.y = element_text(margin = margin(.05, 0, .05, 0, &quot;cm&quot;)))
@
&lt;&lt;echo = T, warning = F, fig.align=&#39;center&#39;, fig.height = 3, fig.width = 3, fig.cap = &quot;Total assets by elapsed days from disbursement, within a group&quot;, fig.lp = &#39;Figure&#39;&gt;&gt;=
library(ggplot2)
ggplot(data = al.sss, aes(x = avgDiffElapsed, y = avgDiffVal)) +
    geom_point(aes(colour = arm, shape = arm), size = .05) + 
    scale_shape(solid = F) + 
    xlab(&quot;difference in elapsed days&quot;) + ylab(&quot;difference in mean value (Tk 1000)&quot;) + 
    labs(fill = &quot;arm&quot;) + facet_grid(arm ~ rd) + 
#   stat_smooth(method = &quot;loess&quot;, size = .2, n = 150) +
    geom_smooth(method = &quot;loess&quot;, size = .2) +
    geom_hline(aes(yintercept = 0), colour=&quot;#990000&quot;, linetype=&quot;dashed&quot;, size = .2) +
    theme(axis.title.y = element_text(size = rel(.25), angle = 90), 
        axis.title.x = element_text(size = rel(.25), angle = 0),
        axis.text.x = element_text(size = rel(.5), angle = 30, hjust = 1),
        axis.text.y = element_text(size = rel(.5), angle = 0),
        legend.text = element_text(size=rel(.25)), 
        legend.position = &quot;bottom&quot;, 
        legend.title = element_text(size = rel(.25)),
        legend.key = element_rect(size = rel(.25)),
        legend.key.size = unit(.15, &quot;cm&quot;),
        strip.text = element_text(size=rel(.5)),
        strip.text.x = element_text(margin = margin(.05, 0, .05, 0, &quot;cm&quot;)),
        strip.text.y = element_text(margin = margin(.05, 0, .05, 0, &quot;cm&quot;)))
@
Regressions. First, get roster files to obtain hh background.
&lt;&lt;&gt;&gt;=
setwd(pathsource.mar)
foldername &lt;- list.dirs(path = &quot;.&quot;, recursive = T, full.names = T)
foldername &lt;- foldername[grepl(&quot;add|ori&quot;, foldername)]
fn1 &lt;- unique(list.files(path = foldername, pattern = &quot;.prn$&quot;, 
    recursive = T, full.names = T))
fn.ros &lt;- grepout(&quot;s1.p1|Se.*01&quot;, fn1)
Ro = lapply(fn.ros, fread, integer64 = &quot;double&quot;)
ro1 &lt;- rbindlist(Ro, fill = T, use.names = T)
ro1 &lt;- ro1[!duplicated(ro1[, .(hhid, mid, memname)]), ]
ro1[, numAdults := sum(age_1 &gt; 15 &amp; age_1 &lt;= 60, na.rm = T), by = hhid]
ro1[, numChildren := sum(age_1 &lt;= 15, na.rm = T), by = hhid]
ro1[, numElderly := sum(age_1 &gt; 60, na.rm = T), by = hhid]
ro1[, numDisabled := sum(grepl(&quot;Y|1&quot;, disability)), by = hhid]
ro1[, numMale := sum(grepl(&quot;M|1&quot;, sex)), by = hhid]
ro1[, numLiterate := sum(grepl(&quot;Can.*and&quot;, literacy) | grepl(&quot;4&quot;, lliteracy)), by = hhid]
ro1[, headLiterate := 
    (grepl(&quot;Can.*and&quot;, literacy)  | grepl(&quot;4&quot;, lliteracy)) &amp; grepl(&quot;He|1&quot;, rel_hhh), 
    by = hhid]
ro1[, numLiterateMale := 
    sum((grepl(&quot;Can.*and&quot;, literacy)  | grepl(&quot;4&quot;, lliteracy)) &amp; grepl(&quot;M|1&quot;, sex)), 
    by = hhid]
ro &lt;- ro1[, .(hhid, numAdults, numChildren, numElderly, 
    numDisabled, numMale, numLiterate, numLiterateMale, headLiterate)]
ro &lt;- ro[!duplicated(ro), ]
setwd(pathsave)
write.tablev(ro, &quot;rd1_roster_summary.prn&quot;)
@
Summarise at cluster level.
&lt;&lt;&gt;&gt;=
tr3 &lt;- tr[, .(gid, hhid)]
setkey(ro1, hhid); setkey(tr3, hhid); 
ros &lt;- tr3[ro1]
ros[, size := .N, by = gid]
ros[, ratioAdults := sum(age_1 &gt; 15 &amp; age_1 &lt;= 60, na.rm = T)/size, by = gid]
ros[, ratioChildren := sum(age_1 &lt;= 15, na.rm = T)/size, by = gid]
ros[, ratioElderly := sum(age_1 &gt; 60, na.rm = T)/size, by = gid]
ros[, ratioDisabled := sum(grepl(&quot;Y|1&quot;, disability))/size, by = gid]
ros[, ratioMale := sum(grepl(&quot;M|1&quot;, sex))/size, by = gid]
ros[, ratioLiterate := sum(grepl(&quot;Can.*and&quot;, literacy) | grepl(&quot;4&quot;, lliteracy))/size, by = gid]
ros[, ratioHeadLiterate := 
    sum((grepl(&quot;Can.*and&quot;, literacy)  | grepl(&quot;4&quot;, lliteracy)) &amp; 
    grepl(&quot;He|1&quot;, rel_hhh))/size, by = gid]
ros[, ratioLiterateMale := 
    sum((grepl(&quot;Can.*and&quot;, literacy)  | grepl(&quot;4&quot;, lliteracy)) &amp; grepl(&quot;M|1&quot;, sex))/size, 
    by = gid]
ro2 &lt;- ros[, .(gid, size, ratioAdults, ratioChildren, ratioElderly, 
    ratioDisabled, ratioMale, ratioLiterate, ratioLiterateMale, ratioHeadLiterate)]
ro2 &lt;- ro2[!duplicated(ro2[, gid]), ]
ro2 &lt;- ro2[!is.na(gid), ]
@
Merge with asset data.
&lt;&lt;&gt;&gt;=
setkey(al.sss, gid, rd); setkey(ro2, gid)
alr.sss &lt;- ro2[al.sss]  
dim(alr.sss &lt;- alr.sss[!duplicated(alr.sss[, .(rd, gid)]), ])
setkey(alr.sss, gid, rd)
alr.sss[, exist := .N, by = gid]
dim(alr.sss &lt;- alr.sss[exist == 3, ])
destat.alr &lt;- destat(alr.sss[, .(elapsed, 
    size, ratioChildren, ratioAdults, ratioDisabled, ratioMale, ratioLiterate, 
    ratioLiterateMale, ratioHeadLiterate, avgDiffElapsed,
    avgDiffVal, avgVal, avgVal1, avgVal0, avgElapsed, avgElapsed1, avgElapsed0)])
destat.alr &lt;- cbind(rownames(destat.alr), destat.alr)
setwd(pathsave)
ltab.alr &lt;- latextab(destat.alr, headercolor = &quot;blue!10&quot;, 
    alternatecolor = &quot;gray90&quot;, delimiterline = NULL, 
    hleft = c(&quot;\\footnotesize\\hfill&quot;, rep(&quot;\\footnotesize\\hfil$&quot;, ncol(destat.alr)-1)), 
    hcenter = c(&quot;2&quot;, rep(&quot;1.0&quot;, ncol(destat.alr)-1)), 
    hright = c(&quot;&quot;, rep(&quot;$&quot;, ncol(destat.alr)-1)))
write.tablev(ltab.alr, &quot;destat_alr_sss.tex&quot;, colnamestrue = F)
dalr.sss1 &lt;- cbind(d.rd = 1, alr.sss[rd==1, .(gid, assignment, arm, elapsed, 
    size, ratioChildren, ratioAdults, ratioDisabled, ratioMale, ratioLiterate, 
    ratioLiterateMale, ratioHeadLiterate, avgDiffElapsed)], 
    alr.sss[rd==2, .(avgDiffVal, avgVal, avgVal1, avgVal0, avgElapsed, avgElapsed1, avgElapsed0)] - 
    alr.sss[rd==1, .(avgDiffVal, avgVal, avgVal1, avgVal0, avgElapsed, avgElapsed1, avgElapsed0)])
dalr.sss2 &lt;- cbind(d.rd = 2, alr.sss[rd==1, .(gid, assignment, arm, elapsed, 
    size, ratioChildren, ratioAdults, ratioDisabled, ratioMale, ratioLiterate, 
    ratioLiterateMale, ratioHeadLiterate, avgDiffElapsed)], 
    alr.sss[rd==3, .(avgDiffVal, avgVal, avgVal1, avgVal0, avgElapsed, avgElapsed1, avgElapsed0)] - 
    alr.sss[rd==2, .(avgDiffVal, avgVal, avgVal1, avgVal0, avgElapsed, avgElapsed1, avgElapsed0)])
dalr.sss &lt;- rbind(dalr.sss1, dalr.sss2)
@
&lt;&lt;&gt;&gt;=
l1 &lt;- glm(avgDiffVal ~ avgDiffElapsed, data = dalr.sss)
l2 &lt;- glm(avgDiffVal ~ avgDiffElapsed:arm, data = dalr.sss)
l3 &lt;- glm(avgDiffVal ~ avgDiffElapsed:arm + 
    size +ratioChildren +ratioAdults +ratioDisabled +ratioMale, data = dalr.sss)
l4 &lt;- glm(avgDiffVal ~ avgDiffElapsed:arm + 
    size +ratioChildren +ratioAdults +ratioDisabled +ratioMale +
    ratioLiterate + ratioLiterateMale + ratioHeadLiterate, data = dalr.sss)
linprob &lt;- list(l1, l2, l3, l4)
linest &lt;- lapply(linprob, clx.regobj, Cluster = &quot;gid&quot;)
linest &lt;- lapply(linest, function(x) x[, -3])
linest &lt;- tabs2latex(linest)
R2 &lt;- round(asn(lapply(linprob, 
    function(x) 1-crossprod(summary(x)$deviance.res)/summary(x)$null.dev)), 3)
en &lt;- asn(lapply(linprob, function(x) length(x$y)))
rn &lt;- rownames(linest)
rn &lt;- gsub(&quot;arm|^se.*&quot;, &quot;&quot;, rn)
rn &lt;- gsub(&quot;:&quot;, &quot; * &quot;, rn)
ltab &lt;- rbind(as.matrix(cbind(rn, linest)), c(&quot;$R^{2}$&quot;, R2), 
    c(&quot;$n$&quot;, en))
write.tablev(latextab(ltab, delimiterline = NULL, alternatecolor2 = &quot;gray90&quot;,
    hleft = c(&quot;\\footnotesize&quot;, rep(&quot;\\scriptsize\\hfil$&quot;, ncol(ltab)-1)),
    hcenter = c(3.5, rep(1.5, ncol(ltab)-1)), 
    hright = c(&quot;\\hfill&quot;, rep(&quot;$&quot;, ncol(ltab)-1)),
    adjustlineskip = &quot;-.4ex&quot;), 
    paste0(pathsave, &quot;asset_regression_alr_sss.tex&quot;), colnamestrue = F)
@

\begin{table}
%\hspace{-2em}\begin{minipage}[t]{9cm}
\hfil\textsc{\footnotesize Table \refstepcounter{table}\thetable: Descriptive statistics of asset regression data\label{destat.alr.sss}}\\
\setlength{\tabcolsep}{1pt}
\renewcommand{\arraystretch}{.6}
\hfil\begin{tikzpicture}
\node (tbl) {\input{c:/data/GUK/analysis/save/destat_alr_sss.tex}};
\input{c:/data/GUK/analysis/program/tablecolortemplate_top_1row.tex}
\end{tikzpicture}
%\end{minipage}
\end{table}

\begin{table}
%\hspace{-2em}\begin{minipage}[t]{9cm}
\hfil\textsc{\footnotesize Table \refstepcounter{table}\thetable: DID estimates of asset impacts\label{FDasset}}\\
\setlength{\tabcolsep}{1pt}
\renewcommand{\arraystretch}{.6}
\hfil\begin{tikzpicture}
\node (tbl) {\input{c:/data/GUK/analysis/save/asset_regression_alr_sss.tex}};
\input{c:/data/GUK/analysis/program/tablecolortemplate_top_1row.tex}
\end{tikzpicture}\\
\renewcommand{\arraystretch}{1}

\vspace{-4ex}
\hfil\begin{tabular}{&gt;{\hfill\scriptsize}p{1cm}&lt;{}&gt;{\hfill\scriptsize}p{.25cm}&lt;{}&gt;{\scriptsize}p{11.5cm}&lt;{\hfill}}
Notes:&amp; 1. &amp; Difference-in-differences estimates of asset accumulation against elapsed days. \\[-1ex]
&amp; 2. &amp; \textsf{large, large grace, cow} are all time invariant and are interacted with a trend term. \\
&amp; 3. &amp; $*$, $**$, $***$ indicate significance levels at 10\%, 5\%, 1\%, respectively.\\
\end{tabular}
%\end{minipage}
\end{table}


{\bibliographystyle{aer}\footnotesize
\setlength{\baselineskip}{11pt}
\bibliography{c:/dropbox/docs/notes/seiro}}

\end{document}
</code></pre>

<pre><code>## Error: &lt;text&gt;:1:1: unexpected input
## 1: % path0 &lt;- &quot;c:/data/GUK/&quot;; path &lt;- paste0(path0, &quot;analysis/&quot;); setwd(pathprogram &lt;- paste0(path, &quot;program/&quot;)); pathsource.mar &lt;- paste0(path, &quot;source/mar/&quot;); pathreceived.nar &lt;- paste0(path0, 
##     ^
</code></pre>

</body>

</html>
